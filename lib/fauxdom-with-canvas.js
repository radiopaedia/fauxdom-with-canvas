var DOM=function(){"use strict";const e=Object.prototype.hasOwnProperty,t=Array.prototype.slice;window.Symbol||(window.Symbol=function(e){return"@@"+e+"_"+Math.floor(4294967295*Math.random()).toString(16)}),Object.assign||(Object.assign=function(t){if(null==t)return t;t=Object(t);for(let s=1;s<arguments.length;s++){var i=arguments[s];if(i&&"object"==typeof i)for(let s in i)e.call(i,s)&&(t[s]=i[s])}return t}),Object.freeze||(Object.freeze=function(e){for(let t in e){const i=Object.getOwnPropertyDescriptor(e,t);i&&"value"in i&&(i.writable=i.configurable=!1,Object.defineProperty(e,t,i))}}),String.fromCodePoint||(String.fromCodePoint=function(){var e,t=[];for(let i=0;i<arguments.length;i++)(0|(e=0|arguments[i]))!==e||e<0||e>1114111?t.push(65533):e<65535?t.push(e):(e-=65536,t.push(e>>10|55296,1023&e|56320));return String.fromCharCode.apply(null,t)}),Function.prototype.bind||(Function.prototype.bind=function(e){var i=this,s=t.call(arguments,1);if("function"!=typeof i)throw new TypeError("Bind must be called on a function");return function(){return i.apply(e,s.concat(t.call(arguments)))}});const i={},s={},r=Object.prototype.hasOwnProperty.bind(s),n=null;class o{constructor(e){if(this.index=0,this.str=e,this.scanChar=this.str[this.index],!r(" ")){for(let e=0;e<=32;e++)s[String.fromCharCode(e)]=null;for(let e=128;e<=159;e++)s[String.fromCharCode(e)]=null}}isWhiteSpace(e){return e!==n&&r(e)}goToString(e,t){if(!1!==t)this.index=this.str.indexOf(e,this.index);else{i[e]||(i[e]=new RegExp(e,"ig")),i[e].lastIndex=this.index;const t=i[e].exec(this.str);this.index=t?t.index:-1}this.index>-1?this.scanChar=this.str[this.index]:(this.index=this.str.length,this.scanChar=n)}goToIndex(e){this.scanChar=this.str[this.index=e]}advance(e){return this.index+=e,this.index>this.str.length?(this.index=this.str.length,this.scanChar=n):this.scanChar=this.str[this.index]}match(e,t){var i=this.str.substr(this.index,e.length);return!1===t&&(e=e.toLowerCase(),i=i.toLowerCase()),i===e&&(this.index+=e.length-1,this.getNextChar(),!0)}peek(){return this.str[this.index+1]}getChar(){return this.scanChar}getNextChar(){return this.index+1<this.str.length?this.scanChar=this.str[++this.index]:(this.index=this.str.length,this.scanChar=n)}getNextAfterWhiteSpace(){var e;do{e=this.getNextChar()}while(e!==n&&r(e));return e}skipWhiteSpace(){for(var e=this.scanChar;e!==n&&r(e);)e=this.getNextChar();return this.scanChar}}const a=Symbol("event-listeners");class l{addEventListener(e,t,i){this[a]=this[a]??new Map;let s=this[a].get(e);s||(s=[],this[a].set(e,s)),s.push({callback:t,capturing:!0===i||!!i?.capture,options:"object"==typeof i?i:{capture:!!i}})}removeEventListener(e,t,i){if(!this[a])return;let s=this[a].get(e);if(!s)return;const r=!!("object"==typeof i?i.capture:i);s.map(((e,i)=>e.callback===t&&e.capturing===r?i:void 0)).reverse().forEach((e=>{void 0!==e&&s.splice(e,1)}))}dispatchEvent(e){let t=!0;if(!this[a])return t;const i=this[a].get(e.type)??[];return i?.forEach((({callback:i})=>{i(e),e.defaultPrevented&&(t=!1)})),t}}const h=Symbol("doctype"),c=Symbol("head"),d=Symbol("body"),u=Symbol("documentElement"),p=Symbol("nodeType"),f=Symbol("parentNode"),N=Symbol("ownerDocument"),g=Symbol("tagName"),E=Symbol("parserOptions"),T=/\s+/g,m=/[gimsuy]*$/,O={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11},y={AREA:!0,BASE:!0,BR:!0,COL:!0,COMMAND:!0,EMBED:!0,HR:!0,IMG:!0,INPUT:!0,KEYGEN:!0,LINK:!0,META:!0,PARAM:!0,SOURCE:!0,TRACK:!0,WBR:!0};function x(e){var t=-1,i=-1,s="HTML";e[h]&&e[E].allowCustomRootElement&&(s=e[h].name.toUpperCase());for(let r=0,n=e.childNodes.length;r<n;r++){if(e.childNodes[r].tagName===s){i=r,e[p]=O.DOCUMENT_NODE,e[u]=e.childNodes[r],e[c]=e[d]=null;for(let t=0;t<e[u].childNodes.length;t++){const i=e[u].childNodes[t];switch(i.tagName){case"HEAD":e[c]=i;break;case"BODY":case"FRAMESET":e[d]=i}if(e[c]&&e[d])break}if(-1!==t){const s=e[c]||e[d]||e[u],r=i-t;for(let n=t;n<i;n++)D(e.childNodes[n],s);s.childNodes.splice(0,0,...e.childNodes.splice(t,r)),i-=r,n-=r}if(i<n-1){const t=e[d]||e[c]||e[u];for(let s=i+1;s<n;s++)D(e.childNodes[s],t);t.childNodes.splice(t.childNodes.length,0,...e.childNodes.splice(i+1))}break}-1===t&&e.childNodes[r].nodeType===O.ELEMENT_NODE&&(t=r)}}function b(e){const t=e[N]||e.getRootNode();return t[p]===O.DOCUMENT_NODE||t[p]===O.DOCUMENT_FRAGMENT_NODE?t:null}function C(e){if(e&&e.length>0)for(let t=0;t<e.length;t++)D(e[t],null)}function D(e,t){const i=null!==t?b(t):null;e[N]!==i&&e.hasChildNodes()&&e.forEach((e=>{e[N]=i}),null),e[f]=t,e[N]=i}function w(e){if(!e.global){let t=e.flags;void 0===t&&(t=e.toString().match(m)[0]),e=new RegExp(e.source,t+"g")}return e}const S=Symbol("element"),_=Symbol("length"),A=/^\S+$/,I=Array.prototype.indexOf,M=Array.prototype.join,v=Array.prototype.splice;class R{constructor(){throw new Error("Cannot directly instantiate DOMTokenList.")}get length(){return this[_]}set length(e){}get value(){return M.call(this," ")}set value(e){if(this[_]>0)for(let t in this)this.hasOwnProperty(t)&&isFinite(t)&&delete this[t];this[_]=0,"string"==typeof e?this.add.apply(this,e.split(T)):delete this[S].attributes.class}add(){for(let e=0;e<arguments.length;e++)-1===I.call(this,arguments[e])&&this.supports(arguments[e])&&(this[this[_]++]=arguments[e]);this[S].attributes.class=this.value}remove(){for(let e,t=0;t<arguments.length;t++)e=I.call(this,arguments[t]),-1!==e&&(v.call(this,e,1),this[_]--);this[S].attributes.class=this.value}item(e){if("number"==typeof e&&e>=0&&e<this[_])return this[e]}toggle(e,t){var i=!1;if(this.supports(e)){let s=I.call(this,e);-1!==s&&!0!==t?(v.call(this,s,1),this[_]--):!1!==t&&(i=!0,-1===s&&(this[this[_]++]=e)),this[S].attributes.class=this.value}return i}contains(e){return-1!==I.call(this,e)}replace(e,t){var i=I.call(this,e);return!!(i>=0&&this.supports(t))&&(-1===I.call(this,t)?this[i]=t:(v.call(this,i,1),this[_]--),this[S].attributes.class=this.value,!0)}supports(e){return!(!e||"string"!=typeof e)&&e.match(A)}}const L=Symbol("element");function U(e){return e.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))}function P(e){return"string"==typeof e&&(!!e.match(/^\-?[a-z_-]*[a-z]$/)||(!!e.match(/^\-\-[A-Za-z_-]*[A-Za-z0-9]$/)||!!e.match(/^[a-zA-Z]+$/)))}function k(e=""){return new Map(e.split(/\s*;\s*/g).filter((e=>e.length)).map((e=>e.trim().match(/^([a-z-]+)\s*:\s*(.*)$/).slice(1))))}function $(e){return Array.from(e?.entries()??[]).map((e=>e.join(": "))).join("; ")}function j(e){return new Proxy({[L]:e},{get(t,i){if(i===L)return e;if(!P(i))return;const s=U(i);return k(e.attributes.style).get(s)},set(t,i,s){if(!P(i))return!0;const r=U(i),n=k(e.attributes.style);return e.attributes.style=$(n.set(r,s)),!0},deleteProperty(t,i){if(!P(i))return;const s=U(i),r=k(e.attributes.style);e.attributes.style=$(r.delete(s))}})}const W=/\r\n|\r|\f/g,G=/\(\s*(even|odd|(?:(?:([+-]?\d*)n)\s*(?:([+-])\s*(\d+))?|([+-]?\d+)))\s*/g,B={Selectors:0,Identifier:1,Iterator:2,IteratorOf:3},H={is:B.Selectors,not:B.Selectors,where:B.Selectors,has:B.Selectors,lang:B.Identifier,dir:B.Identifier,"nth-child":B.IteratorOf,"nth-last-child":B.IteratorOf,"nth-of-type":B.Iterator,"nth-last-of-type":B.Iterator,"nth-col":B.Iterator,"nth-last-col":B.Iterator};function F(e){return Y(new o(e.replace(W,"\n")))}function Y(e,t=n,i=!1){for(var s=e.skipWhiteSpace(),r={},o=[],a=[o],l=[a];s!==n&&s!==t;){switch(s){case"*":if(o.length>0)throw V("Universal selectors must come before all other simple selectors.",e);r.type="universal",o.push(r),r={};break;case"#":case".":{e.getNextChar();const t=z(e);if(!t)throw V("Expected an identifier.",e);r.type="#"===s?"id":"class",r.name=t,o.push(r),r={};break}case"[":{e.getNextAfterWhiteSpace();const t=z(e);if(!t)throw V("Expected an identifier.",e);if(r.type="attr",r.name=t,r.comparison="=",r.value=!0,r.ignoreCase=!1,"]"!==(s=e.getNextAfterWhiteSpace())){switch(s){case"=":break;case"~":case"|":case"^":case"$":case"*":if("="!==e.peek())throw V("Expected '='.",e,1);r.comparison=s+r.comparison,e.getNextChar();break;default:throw V("Unexpected character '"+(s===n?"END_OF_INPUT":s)+"'.",e)}if("'"===(s=e.getNextAfterWhiteSpace())||'"'===s){const t=s;for(r.value="",s=e.getNextChar();s!==n&&s!==t&&"\n"!==s;)"\\"===s?(r.value+=X(e),s=e.getChar()):(r.value+=s,s=e.getNextChar())}else{const t=z(e);if(!t)throw V("Expected an identifier.",e);r.value=t}if("]"!==e.getNextAfterWhiteSpace()){const t=z(e);if("i"===t||"I"===t)r.ignoreCase=!0;else if("s"===t||"S"===t)r.ignoreCase=!1;else if(t)throw V("Unexpected identifier '"+t+"'.",e,1-t.length);if("]"!==e.getNextAfterWhiteSpace())throw V("Expected ']'.",e,-1+t.length)}}o.push(r),r={};break}case":":if(e.getNextChar(),e.match(":")){const t=z(e);if(!t)throw V("Expected a pseudo-element name.",e);r.type="pseudo-element",r.name=t}else{const t=z(e);if(!t)throw V("Expected a pseudo-class name.",e);r.type="pseudo-class",r.name=t;const i=H[t];if(null!=i){if(r.type="pseudo-fn","("!==e.getNextChar())throw V("Expected '('.",e);switch(i){case B.IteratorOf:case B.Iterator:let t,s=0,n=0;G.lastIndex=e.index;const o=G.exec(e.str);if(!o)throw V("Invalid parameter.",e,1);if(e.advance(o[0].length),i===B.IteratorOf){e.skipWhiteSpace();const i=e.index;if("of"===z(e).toLowerCase()){const i=e.getNextChar();if(")"!==i&&!e.isWhiteSpace(i))throw V("Expected whitespace.",e);if(t=Y(e,")"),!(t instanceof Array)||0===t.length)throw V("Expected at least one selector.",e)}else e.goToIndex(i)}if(")"!==e.skipWhiteSpace())throw V("Expected ')'.",e);"even"===o[1]||"odd"===o[1]?(s=2,"odd"===o[1]&&(n=1)):o[5]?n=parseInt(o[5],10):(s="-"===o[2]?-1:o[2]&&"+"!==o[2]?parseInt(o[2],10):1,o[3]&&(n=parseInt(o[3]+o[4],10))),r.params=[s,n],t&&r.params.push(t);break;case B.Selectors:if(e.getNextChar(),r.params=Y(e,")",!0),0===r.params.length)throw V("Expected at least one selector.",e);break;case B.Identifier:if(!Z(e.getNextAfterWhiteSpace()))throw V("Expected an identifier.",e);r.params=[z(e)],e.getNextChar()}if(")"!==e.skipWhiteSpace())throw V("Expected ')'.",e)}else"before"!==t&&"after"!==t&&"first-line"!==t&&"first-letter"!==t||(r.type="pseudo-element")}o.push(r),r={};break;case"+":case">":case"~":if(0===o.length){if(1===a.length){if(!i)throw V("Absolute selectors cannot start with a combinator.",e);a.unshift([{type:"pseudo-class",name:"scope"}])}else if("string"==typeof a[a.length-2])throw V("Cannot have multiple combinators in a row.",e);a.splice(a.length-1,0,s)}else a.push(s,o=[]);break;case",":if(0===o.length){if(a.length>1){if(a.pop(),"string"==typeof a[a.length-1])throw V("Complex selectors are not allowed to end with a combinator.",e,-1);l.push(a=[o])}}else l.push(a=[o=[]]);e.skipWhiteSpace();break;default:if(e.isWhiteSpace(s))o.length>0&&a.push(o=[]),e.skipWhiteSpace(),e.advance(-1);else{if(!Z(s))throw V("Unexpected character '"+s+"'.",e);if(o.length>0)throw V("Type (tag name) selectors must come before all other simple selectors.",e);r.type="type",r.name=z(e).toUpperCase(),o.push(r),r={}}}s=e.getNextChar()}if(0===o.length&&(1===a.length?(l.pop(),a=l[l.length-1]):a.pop()),a&&"string"==typeof a[a.length-1])throw V("Complex selectors are not allowed to end with a combinator.",e,-1);return l}function V(e,t,i=0){var s=new SyntaxError(e),r=t.index+i;return s.stack="SyntaxError: "+e+"\n\n"+t.str+"\n"+" ".repeat(r)+"^\n    at index "+r,s}function z(e){var t="",i=e.getChar();if(Z(i)){do{"\\"===i?(t+=X(e),i=e.getChar()):(t+=i,i=e.getNextChar())}while(i!==n&&(Z(i)||i>="0"&&i<="9"||"-"===i));e.advance(-1)}return t}function X(e){var t=e.getNextChar();if(q(t)){let i="";for(let s=5;s>=0&&q(t);s--)i+=t,t=e.getNextChar();return e.isWhiteSpace(t)&&e.getNextChar(),i=0|parseInt(i,16),0===i||i>=55296&&i<=57343||i>1114111?"�":String.fromCodePoint(i)}return t===n?"�":(e.getNextChar(),t)}function q(e){return e!==n&&(e>="0"&&e<="9"||e>="A"&&e<="F"||e>="a"&&e<="f")}function Z(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"||"_"===e||e>=""||"\\"===e}const K=0,J=1,Q=2,ee=3,te=4,ie={">":Q,"+":ee,"~":te},se={is:(e,t,i)=>oe(e,t,i),not:(e,t,i)=>!oe(e,t,i),has(e,t,i){var s=!1;for(let r=0;r<i.length;r++)if(i[r][0]instanceof Array&&le(i[r][0][0])){s=oe(t,t,i,!0);break}return!s&&t.childNodes.length>0&&t.forEach((e=>{if(oe(t,e,i))return s=!0,!1})),s},"nth-child"(e,t,i){const s=t[f],r=s.childNodes,n=new he(i[0],i[1]);for(let o=0;o<r.length;o++)if(r[o][p]===ge.ELEMENT_NODE&&(!i[2]||oe(s,r[o],i[2]))){const e=n.next();if(r[o]===t)return e}return!1},"nth-last-child"(e,t,i){const s=t[f],r=s.childNodes,n=new he(i[0],i[1]);for(let o=r.length-1;o>=0;o--)if(r[o][p]===ge.ELEMENT_NODE&&(!i[2]||oe(s,r[o],i[2]))){const e=n.next();if(r[o]===t)return e}return!1},"nth-of-type"(e,t,i){const s=t[f].childNodes,r=new he(i[0],i[1]),n=t[g];for(let o=0;o<s.length;o++)if(s[o][g]===n){const e=r.next();if(s[o]===t)return e}},"nth-last-of-type"(e,t,i){const s=t[f].childNodes,r=new he(i[0],i[1]),n=t[g];for(let o=s.length-1;o>=0;o--)if(s[o][g]===n){const e=r.next();if(s[o]===t)return e}}},re={scope:(e,t)=>t===e,enabled(e,t){switch(t[g]){case"BUTTON":case"INPUT":case"SELECT":case"TEXTAREA":case"OPTGROUP":case"OPTION":case"FIELDSET":return!t.hasAttribute("disabled")}return!1},disabled(e,t){switch(t[g]){case"BUTTON":case"INPUT":case"SELECT":case"TEXTAREA":case"OPTGROUP":case"OPTION":case"FIELDSET":return t.hasAttribute("disabled")}return!1},checked(e,t){if("INPUT"===t[g]){const e=t.getAttribute("type");if("checkbox"===e||"radio"===e)return t.hasAttribute("checked")}else if("OPTION"===t[g])return t.hasAttribute("selected");return!1},required(e,t){switch(t[g]){case"INPUT":case"SELECT":case"TEXTAREA":return t.hasAttribute("required")}return!1},optional(e,t){switch(t[g]){case"INPUT":case"SELECT":case"TEXTAREA":return!t.hasAttribute("required")}return!1},root(e,t){const i=b(e);return!!i&&i.documentElement===t},empty:(e,t)=>0===t.childNodes.length,"first-child"(e,t){const i=t[f].childNodes;for(let s=0;s<i.length;s++)if(i[s][p]===ge.ELEMENT_NODE)return i[s]===t},"last-child"(e,t){const i=t[f].childNodes;for(let s=i.length-1;s>=0;s--)if(i[s][p]===ge.ELEMENT_NODE)return i[s]===t},"only-child"(e,t){const i=t[f].childNodes;let s,r;for(let n=0,o=i.length-1;o>=0&&(!s||!r);n++,o--)s||i[n][p]!==ge.ELEMENT_NODE||(s=i[n]),r||i[o][p]!==ge.ELEMENT_NODE||(r=i[o]);return s===r&&s===t},"first-of-type"(e,t){const i=t[f].childNodes,s=t[g];for(let r=0;r<i.length;r++)if(i[r][g]===s)return i[r]===t},"last-of-type"(e,t){const i=t[f].childNodes,s=t[g];for(let r=i.length-1;r>=0;r--)if(i[r][g]===s)return i[r]===t},"only-of-type"(e,t){const i=t[f].childNodes,s=t[g];let r,n;for(let o=0,a=i.length-1;a>=0&&(!r||!n);o++,a--)r||i[o][g]!==s||(r=i[o]),n||i[a][g]!==s||(n=i[a]);return r===n&&r===t}};function ne(e,t,i){const s=F(t),r=[];return e.forEach((t=>{if(oe(e,t,s)&&(r.push(t),!i))return!1})),i?r:r[0]||null}function oe(e,t,i,s=!1){var r;e:for(let n=0;n<i.length;n++){const o=i[n];let a=K;if(!(s&&o[0]instanceof Array)||le(o[0][0])){r=t;t:for(let t=s?0:o.length-1;s?t<o.length:t>=0;s?t++:t--)if(ie.hasOwnProperty(o[t]))a=ie[o[t]];else switch(a){case K:if(!ae(e,r,o[t]))continue e;a=J;break;case J:for(;r=r[f];)if(ae(e,r,o[t]))continue t;continue e;case Q:if(!ae(e,r=r[f],o[t]))continue e;break;case ee:{const i=r[f].childNodes;if(!ae(e,r=i[i.indexOf(r)+(s?1:-1)],o[t]))continue e;break}case te:{const i=r[f].childNodes;for(let n=i.indexOf(r)+(s?1:-1);s?n<i.length:n>=0;s?n++:n--)if(ae(e,i[n],o[t])){r=i[n];continue t}continue e}}return!0}}return!1}function ae(e,t,i){if(!t||t[p]!==ge.ELEMENT_NODE)return!1;for(let s=0;s<i.length;s++){const r=i[s];let n;switch(n=!1,r.type){case"universal":return!0;case"type":n=t[g]===r.name;break;case"id":n=t.id===r.name;break;case"class":n=t.classList.contains(r.name);break;case"attr":if("="!==r.comparison||!0!==r.value&&""!==r.value){let e=t.getAttribute(r.name);if("string"==typeof e){let t=r.ignoreCase?r.value.toLowerCase():r.value;if(r.ignoreCase&&(e=e.toLowerCase()),""!==t)switch(r.comparison){case"=":n=e===t;break;case"~=":n=-1!==e.split(T).indexOf(t);break;case"|=":n=e===t||e.startsWith(t+"-");break;case"^=":n=e.startsWith(t);break;case"$=":n=e.endsWith(t);break;case"*=":n=-1!==e.indexOf(t)}}}else n=t.hasAttribute(r.name);break;case"pseudo-element":break;case"pseudo-class":re.hasOwnProperty(r.name)&&(n=!!re[r.name].call(null,e,t));break;case"pseudo-fn":se.hasOwnProperty(r.name)&&(n=!!se[r.name].call(null,e,t,r.params))}if(!n)return!1}return!0}function le(e){return!!e&&"pseudo-class"===e.type&&"scope"===e.name}se.where=se.is;class he{constructor(e,t){this.A=0|parseInt(e,10),this.B=0|parseInt(t,10),this.current=0}next(){if(0===this.A&&0===this.B)return!1;this.current+=1;let e=!1;return 0===this.A?e=this.current===this.B:(this.A<0&&this.B>=this.current||this.A>0&&this.current>=this.B)&&(e=(this.current+this.B)%this.A==0),e}}function ce(e){var t=e.tagName,i=b(e),s=i?i.entityEncoder:null,r="";switch(e.nodeType){case O.ELEMENT_NODE:r+="<"+(t=t.toLowerCase());for(let t in e.attributes)if(e.attributes.hasOwnProperty(t)){let n=e.attributes[t];!0===n?n="":s&&i[E]&&(n=de(n,s,i[E])),r+=" "+t,""!==n&&(r+='="'+n+'"')}r+=">";for(let t=0;t<e.childNodes.length;t++)r+=ce(e.childNodes[t]);!0!==y[e.tagName]&&(r+="</"+t+">");break;case O.TEXT_NODE:s&&i[E]&&(!e.parentNode||"SCRIPT"!==e.parentNode.tagName&&"STYLE"!==e.parentNode.tagName)?r+=de(e.nodeValue,s,i[E]):r+=e.nodeValue;break;case O.CDATA_SECTION_NODE:r+="<![CDATA["+e.nodeValue+"]]>";break;case O.PROCESSING_INSTRUCTION_NODE:r+="<?"+e.nodeName,e.nodeValue&&(r+=" "+e.nodeValue),r+="?>";break;case O.COMMENT_NODE:r+="\x3c!--"+e.nodeValue+"--\x3e";break;case O.DOCUMENT_TYPE_NODE:r+="<!DOCTYPE",e.name&&(r+=" "+e.name),e.publicId&&(r+=' PUBLIC "'+e.publicId+'"'),e.systemId&&(e.publicId||(r+=" SYSTEM"),r+=' "'+e.systemId+'"'),r+=">"}return r}function de(e,t,i){return!1===i.encodeEntities?e:!0!==i.encodeEntities&&i.encodeEntities instanceof RegExp?t.encode(e,i.encodeEntities):t.encode(e)}const ue=Symbol("classList"),pe=Symbol("style"),fe=Symbol("extendNode");function Ne(e,t=ge){const i=Object.create(t.prototype);switch(i[p]=e,i.nodeValue=null,i[f]=null,i[N]=null,e){case ge.ELEMENT_NODE:i[g]=null,i.attributes={};case ge.DOCUMENT_NODE:case ge.DOCUMENT_FRAGMENT_NODE:i.childNodes=[]}return i}class ge extends l{constructor(){if(super(),arguments[0]!==fe)throw new Error("Cannot directly instantiate Node.")}get nodeType(){return this[p]}get nodeName(){switch(this.nodeType){case ge.ELEMENT_NODE:return this.tagName;case ge.TEXT_NODE:return"#text";case ge.CDATA_SECTION_NODE:return"#cdata-section";case ge.PROCESSING_INSTRUCTION_NODE:return this.target;case ge.COMMENT_NODE:return"#comment";case ge.DOCUMENT_NODE:return"#document";case ge.DOCUMENT_TYPE_NODE:return this.name;case ge.DOCUMENT_FRAGMENT_NODE:return"#document-fragment"}}get parentNode(){return this[f]}get ownerDocument(){return this[N]}get tagName(){return this[g]||null}get firstChild(){return this.childNodes&&this.childNodes[0]||null}get lastChild(){return this.childNodes&&this.childNodes[this.childNodes.length-1]||null}get previousSibling(){const e=this.parentNode;if(e){const t=e.childNodes.indexOf(this);if(t>0)return e.childNodes[t-1]}return null}get nextSibling(){const e=this.parentNode;if(e){const t=e.childNodes.indexOf(this);if(t>-1&&t<e.childNodes.length-1)return e.childNodes[t+1]}return null}get id(){return this.attributes&&this.attributes.id||""}set id(e){this.attributes&&(this.attributes.id=e)}get className(){return this.attributes&&this.attributes.class||""}set className(e){this.attributes&&(this.classList.value=e,this.attributes.class=this[ue].value)}get classList(){return this.attributes?(this[ue]||(this[ue]=function(e){const t=Object.create(R.prototype);t[_]=0,t[S]=e;const i=e.className;return i&&(t.value=i),t}(this)),this[ue]):null}get innerHTML(){if(this.nodeType===ge.ELEMENT_NODE){let e="";for(let t=0;t<this.childNodes.length;t++)e+=ce(this.childNodes[t]);return e}return null}set innerHTML(e){if(this.nodeType===ge.ELEMENT_NODE&&!0!==y[this.tagName]){const t=me(this,e);t?Te(this,t,0,this.childNodes.length):(C(this.childNodes),this.childNodes.length=0)}}get outerHTML(){return ce(this)}set outerHTML(e){if(this.parentNode){const t=this.parentNode.childNodes.indexOf(this),i=me(this,e);i?Te(this.parentNode,i,t,1):C(this.parentNode.childNodes.splice(t,1))}}get style(){return this.attributes?(this[pe]||(this[pe]=j(this)),this[pe]):null}set style(e){this.attributes&&(this[pe]||(this[pe]=j(this)),function(e,t){const i=$(k(t));e[L].attributes.style=i}(this[pe],e))}get textContent(){if(this.childNodes){let e="";for(let t=0;t<this.childNodes.length;t++)this.childNodes[t].nodeType!==ge.COMMENT_NODE&&this.childNodes[t].nodeType!==ge.CDATA_SECTION_NODE&&this.childNodes[t].nodeType!==ge.PROCESSING_INSTRUCTION_NODE&&(e+=this.childNodes[t].textContent);return e}return this.nodeValue}set textContent(e){if(null==e?e="":"string"!=typeof e&&(e+=""),this.childNodes){let t=Ne(ge.TEXT_NODE);t.nodeValue=e,D(t,this),C(this.childNodes),this.childNodes.length=1,this.childNodes[0]=t}else this.nodeType>=ge.TEXT_NODE&&this.nodeType<=ge.COMMENT_NODE&&(this.nodeValue=e)}getRootNode(){let e=this;for(;e.parentNode;)e=e.parentNode;return e}hasAttributes(){if(this.attributes)for(let e in this.attributes)if(this.attributes.hasOwnProperty(e))return!0;return!1}getAttributeNames(){return this.attributes?Object.keys(this.attributes):[]}getAttribute(e){var t;return this.attributes&&e&&"string"==typeof e&&(t=this.attributes[Oe(this,e)]),void 0===t?null:t}setAttribute(e,t){this.attributes&&e&&"string"==typeof e&&("class"===(e=Oe(this,e))?!0!==t?this.className=""+t:(this.classList.value="",this.attributes[e]=!0):this.attributes[e]="string"==typeof t||!0===t?t:""+t)}toggleAttribute(e,t){if(this.attributes&&e&&"string"==typeof e)return e=Oe(this,e),this.attributes.hasOwnProperty(e)?1!==arguments.length&&!1!==t||(delete this.attributes[e],!1):(1===arguments.length||!0===t)&&(this.attributes[e]=!0)}removeAttribute(e){this.attributes&&e&&"string"==typeof e&&("class"===(e=Oe(this,e))&&this[ue]&&(this[ue].value=null),delete this.attributes[e])}hasAttribute(e){return!(!this.attributes||!e||"string"!=typeof e)&&this.attributes.hasOwnProperty(Oe(this,e))}hasChildNodes(){return!!this.childNodes&&this.childNodes.length>0}appendChild(e){return this.insertBefore(e,null)}insertBefore(e,t){if(this.childNodes&&e instanceof ge&&arguments.length>1){let i=-1;if(null==t?i=this.childNodes.length:t instanceof ge&&t.parentNode===this&&(i=this.childNodes.indexOf(t)),-1!==i)return Te(this,e,i)}return null}replaceChild(e,t){return this.childNodes&&t instanceof ge&&e instanceof ge&&t.parentNode===this&&t!==e?(Te(this,e,this.childNodes.indexOf(t),1),t):null}removeChild(e){if(this.childNodes&&e instanceof ge&&e.parentNode===this){const t=this.childNodes.indexOf(e),i=b(this);return i&&e.parentNode===i.documentElement&&Ee.hasOwnProperty(e.tagName)&&(i[Ee[e.tagName]]=null),C(this.childNodes.splice(t,1)),e}return null}cloneNode(e){var t;switch(t=this.nodeType===ge.DOCUMENT_NODE||this.nodeType===ge.DOCUMENT_FRAGMENT_NODE?new Ze(null,this[E]):Ne(this.nodeType),this.nodeType){case ge.ELEMENT_NODE:t[g]=this.tagName,t.attributes=Object.assign(t.attributes,this.attributes);break;case ge.TEXT_NODE:case ge.CDATA_SECTION_NODE:case ge.PROCESSING_INSTRUCTION_NODE:case ge.COMMENT_NODE:t.nodeValue=this.nodeValue;break;case ge.DOCUMENT_NODE:case ge.DOCUMENT_FRAGMENT_NODE:t[p]=this.nodeType,t.entityEncoder.entities=this.entityEncoder;break;case ge.DOCUMENT_TYPE_NODE:t.name=this.name,t.publicId=this.publicId,t.systemId=this.systemId}if(!0===e&&this.childNodes&&this.childNodes.length>0){for(let e=0;e<this.childNodes.length;e++)t.appendChild(this.childNodes[e].cloneNode(!0));t.nodeType!==ge.DOCUMENT_NODE&&t.nodeType!==ge.DOCUMENT_FRAGMENT_NODE||x(t)}return t}getElementById(e){var t=null;return e&&"string"==typeof e&&this.childNodes&&this.forEach((i=>{if(i.id===e)return t=i,!1})),t}getElementsByClassName(e){var t=[];if(e&&"string"==typeof e){const i=e.trim().split(T);(i.length>1||""!==i[0])&&this.forEach((e=>{for(let t=0;t<i.length;t++)if(!e.classList.contains(i[t]))return;t.push(e)}))}return t}getElementsByTagName(e){var t=[];return e&&"string"==typeof e&&(e=e.toUpperCase(),this.forEach((i=>{"*"!==e&&i.tagName!==e||t.push(i)}))),t}closest(e){return e&&"string"==typeof e?function(e,t){const i=F(t);let s=e;for(;null!=s&&s[p]===ge.ELEMENT_NODE;){if(oe(e,s,i))return s;s=s[f]}return null}(this,e):null}matches(e){return!(!e||"string"!=typeof e)&&function(e,t){return oe(e,e,F(t))}(this,e)}querySelector(e){return e&&"string"==typeof e?ne(this,e,!1):null}querySelectorAll(e){return e&&"string"==typeof e?ne(this,e,!0):[]}forEach(e,t=O.ELEMENT_NODE){let i,s,r=this.childNodes,n=this.firstChild,o=[],a=0;for(;n;){if(i=n[f],s=r[a+1],(null===t||n.nodeType===t)&&!1===e(n,i))return;if(n[f]===i&&n.childNodes&&n.childNodes.length>0)o.push(a),r=n.childNodes,n=r[a=0];else{for(s?(a+=1,s!==r[a]&&(a=i.childNodes.indexOf(s))):a=r.length;null==r[a];){if(n=i,i=n[f],!n||n===this)return;r=i.childNodes,a=o.pop()+1}n=r[a]}}}}Object.defineProperties(ge,{ELEMENT_NODE:{value:O.ELEMENT_NODE},TEXT_NODE:{value:O.TEXT_NODE},CDATA_SECTION_NODE:{value:O.CDATA_SECTION_NODE},PROCESSING_INSTRUCTION_NODE:{value:O.PROCESSING_INSTRUCTION_NODE},COMMENT_NODE:{value:O.COMMENT_NODE},DOCUMENT_NODE:{value:O.DOCUMENT_NODE},DOCUMENT_TYPE_NODE:{value:O.DOCUMENT_TYPE_NODE},DOCUMENT_FRAGMENT_NODE:{value:O.DOCUMENT_FRAGMENT_NODE}});const Ee={HEAD:c,BODY:d,FRAMESET:d};function Te(e,t,i,s=0){if(!e||e.nodeType!==ge.ELEMENT_NODE&&e.nodeType!==ge.DOCUMENT_NODE&&e.nodeType!==ge.DOCUMENT_FRAGMENT_NODE||e.nodeType===ge.ELEMENT_NODE&&!0===y[e.tagName])return t;if(t.nodeType<=ge.COMMENT_NODE){if(e.parentNode&&e.parentNode.nodeType===ge.DOCUMENT_NODE&&Ee.hasOwnProperty(t.tagName)){const i=Ee[t.tagName];if(e.parentNode[i]&&0===s)return t;e.parentNode[i]=t}t.parentNode&&t.parentNode.removeChild(t),D(t,e),C(e.childNodes.splice(i,s,t))}else if(t.nodeType!==ge.DOCUMENT_TYPE_NODE||e.nodeType!==ge.DOCUMENT_NODE&&e.nodeType!==ge.DOCUMENT_FRAGMENT_NODE){if(t.nodeType===ge.DOCUMENT_FRAGMENT_NODE)if(e.parentNode&&e.parentNode.nodeType===ge.DOCUMENT_NODE){s>0&&C(e.childNodes.splice(i,s));for(let r=t.childNodes.length-1;r>=0;r--){const n=t.childNodes[r];if(Ee.hasOwnProperty(n.tagName)){const t=Ee[n.tagName];if(e.parentNode[t]&&0===s)continue;e.parentNode[t]=n}D(n,e),e.childNodes.splice(i,0,n),t.childNodes.splice(r,1)}}else if(t!==b(e)){for(let i=0;i<t.childNodes.length;i++)D(t.childNodes[i],e);C(e.childNodes.splice(i,s,...t.childNodes)),t.childNodes.length=0}}else{const r=t.parentNode;!r||r.nodeType!==ge.DOCUMENT_NODE&&r.nodeType!==ge.DOCUMENT_FRAGMENT_NODE||(r.removeChild(t),r[h]=null),D(t,e),C(e.childNodes.splice(i,s,t)),e[h]=t}return t}function me(e,t){if(t&&"string"==typeof t){const i=b(e);return new Me(t,i?i[E]:null,i?i.entityEncoder:null).parseHTML()}}function Oe(e,t){const i=b(e);return i&&i[E].lowerAttributeCase?t.toLowerCase():t}const ye=String.prototype.toLowerCase,xe=String.prototype.toUpperCase,be={allowCustomRootElement:!1,allowSelfClosingSyntax:!1,allowCDATA:!1,allowProcessingInstructions:!1,decodeEntities:!1,encodeEntities:!1,collapseWhitespace:!1,trimWhitespace:!1,lowerAttributeCase:!1},Ce={">":!0,"/":!0,"=":!0},De={P:!0},we={DT:!0,DD:!0},Se={TBODY:!0,THEAD:!0,TFOOT:!0},_e={TD:!0,TH:!0},Ae={BUTTON:!0,DATALIST:!0,OPTGROUP:!0,OPTION:!0,PROGRESS:!0,SELECT:!0,TEXTAREA:!0},Ie={ADDRESS:De,ARTICLE:De,ASIDE:De,BLOCKQUOTE:De,DIV:De,FIELDSET:De,FOOTER:De,H1:De,H2:De,H3:De,H4:De,H5:De,H6:De,HEADER:De,HGROUP:De,HR:De,MAIN:De,NAV:De,P:De,PRE:De,SECTION:De,BODY:{HEAD:!0,TITLE:!0},DL:De,DD:we,DT:we,TABLE:De,TBODY:Se,THEAD:Se,TD:_e,TFOOT:Se,TH:_e,TR:{TR:!0},LI:{LI:!0},OL:De,UL:De,BUTTON:Ae,DATALIST:Ae,FORM:De,INPUT:Ae,OPTGROUP:{OPTGROUP:!0,OPTION:!0},OPTION:{OPTION:!0},OUTPUT:Ae,PROGRESS:Ae,SELECT:Ae,TEXTAREA:Ae};class Me{constructor(e,t,i){this.options=Me.setupOptions(t),this.lexer=new o(e),this.entityEncoder=i}static setupOptions(e){return(e=Object.assign({},be,e)).encodeEntities instanceof RegExp&&(e.encodeEntities=w(e.encodeEntities)),Object.freeze(e)}static isNameCharStart(e){return":"===e||"_"===e||e>="A"&&e<="Z"||e>="a"&&e<="z"||e>="À"&&e<="Ö"||e>="Ø"&&e<="ö"||e>="ø"&&e<="˿"||e>="Ͱ"&&e<="ͽ"||e>="Ϳ"&&e<="῿"||"‌"===e||"‍"===e||e>="⁰"&&e<="↏"||e>="Ⰰ"&&e<="⿯"||e>="、"&&e<="퟿"||e>="豈"&&e<="﷏"||e>="ﷰ"&&e<="�"||e>="က0"&&e<="F"}static isNameChar(e){return Me.isNameCharStart(e)||e>="0"&&e<="9"||"-"===e||"."===e||"·"===e||e>="̀"&&e<="ͯ"||"‿"===e||"⁀"===e}parseHTML(){var e,t=Ne(ge.DOCUMENT_FRAGMENT_NODE),i=[t];for(t[E]=this.options,e=this.options.trimWhitespace?this.lexer.skipWhiteSpace():this.lexer.getChar();e!==n&&i.length>0;)"<"===e?this.parseTag(i):this.parseText(i),e=this.options.trimWhitespace?this.lexer.skipWhiteSpace():this.lexer.getChar();return t}parseTag(e){var t,i,s,r,o=0,a=this.lexer.index,l=this.lexer.getNextChar();if(l!==n)e:for(;">"!==l&&l!==n;){if(s=this.lexer.index,0===o){if("!"===l||"?"===l){if(this.options.allowProcessingInstructions&&this.lexer.match("?")){s=this.lexer.index,l=this.lexer.getChar();t:if(Me.isNameCharStart(l)){for(t=Ne(ge.PROCESSING_INSTRUCTION_NODE);l!==n&&Me.isNameChar(l);)l=this.lexer.getNextChar();if(!this.lexer.isWhiteSpace(l)&&l!==n&&("?"!==l||">"!==this.lexer.peek()))break t;t.target=this.lexer.str.slice(s,this.lexer.index),this.lexer.skipWhiteSpace(),s=this.lexer.index,this.lexer.goToString("?>"),t.nodeValue=this.lexer.str.slice(s,this.lexer.index),this.lexer.advance(1),e[0].childNodes.push(t),D(t,e[0]);break}this.lexer.advance(s-this.lexer.index-1)}if(this.options.allowCDATA&&this.lexer.match("![CDATA[")){t=Ne(ge.CDATA_SECTION_NODE),s=this.lexer.index,this.lexer.goToString("]]>"),t.nodeValue=this.lexer.str.slice(s,this.lexer.index),this.lexer.advance(2),e[0].childNodes.push(t),D(t,e[0]);break}if(this.lexer.match("!DOCTYPE",!1)){this.lexer.skipWhiteSpace(),s=this.lexer.index,this.lexer.goToString(">");let i=e[e.length-1];if(i.doctype)break;if(i.childNodes.length>0)for(let e=i.childNodes.length-1;e>=0;e--)if(i.childNodes[e].nodeType<ge.TEXT_NODE||i.childNodes[e].nodeType>ge.COMMENT_NODE)break e;let r=this.lexer.str.slice(s,this.lexer.index).split(T);if((t=Ne(ge.DOCUMENT_TYPE_NODE)).name=ye.call(r.shift()),r.length>1){let e=ye.call(r.shift());if(r=r.join(" ").split('"'),""===r[0])switch(e){case"public":r.shift(),t.publicId=r.shift();case"system":r.shift(),t.systemId=r.shift()}}t.publicId||(t.publicId=""),t.systemId||(t.systemId=""),i.childNodes.push(t),i.doctype=t,D(t,i);break}{let i;this.lexer.match("!--")?this.lexer.match(">")||this.lexer.match("->")||(i="--\x3e"):("!"===l&&this.lexer.getNextChar(),i=">"),t=Ne(ge.COMMENT_NODE),s=this.lexer.index,i&&this.lexer.goToString(i),t.nodeValue=this.lexer.str.slice(s,this.lexer.index),this.lexer.advance(i?i.length-1:-1),e[0].childNodes.push(t),D(t,e[0]);break}}"/"===l&&(l=this.lexer.getNextChar(),o=2,s+=1)}if(1===o){for(;this.lexer.index===s&&"="===l||!this.lexer.isWhiteSpace(l)&&!Ce[l]&&l!==n;)l=this.lexer.getNextChar();r=this.lexer.index}else{for(;(l>="a"&&l<="z"||l>="A"&&l<="Z"||this.lexer.index>s&&(l>="0"&&l<="9"||"-"===l||"_"===l||":"===l))&&l!==n;)l=this.lexer.getNextChar();if(r=this.lexer.index,l===n)return void this.addTextNode(e,a,r,!1);l=this.lexer.skipWhiteSpace(),2===o&&(l=this.lexer.goToString(">"))}if(s===r){if(!this.options.allowSelfClosingSyntax||"/"!==l||">"!==this.lexer.peek()){if(0===o){this.lexer.goToString("<"),this.addTextNode(e,a,this.lexer.index,!1),a=this.lexer.index,l=this.lexer.getNextChar();continue}if(2===o){if(s===this.lexer.index)break;(t=this.addTextNode(e,s,this.lexer.index))[p]=ge.COMMENT_NODE;break}this.lexer.getNextChar(),l=this.lexer.skipWhiteSpace();continue}l=this.lexer.getNextChar(),o=2,i=e[0][g]}else i=this.lexer.str.slice(s,r),1!==o&&(i=xe.call(i)),l=this.lexer.skipWhiteSpace();switch(o){case 0:for((t=Ne(ge.ELEMENT_NODE))[g]=i;Ie.hasOwnProperty(t[g])&&Ie[t[g]][e[0][g]];)e.splice(0,1);e[0].childNodes.push(t),D(t,e[0]),o=1,!0!==y[t[g]]&&e.unshift(t);break;case 1:let a=!0;if(this.options.lowerAttributeCase&&(i=ye.call(i)),"="===l){if(this.lexer.getNextChar(),l=this.lexer.skipWhiteSpace(),s=this.lexer.index,'"'===l||"'"===l)this.lexer.getNextChar(),this.lexer.goToString(l),r=this.lexer.index,s+=1,this.lexer.getNextChar(),l=this.lexer.skipWhiteSpace();else{for(;!(this.lexer.isWhiteSpace(l)||
//!unquotedAttributeExclusions[theChar] &&
">"===l||this.options.allowSelfClosingSyntax&&"/"===l&&">"===this.lexer.peek()||l===n);)l=this.lexer.getNextChar();r=this.lexer.index,l=this.lexer.skipWhiteSpace()}if(t.attributes.hasOwnProperty(i))break;a=this.lexer.str.slice(s,r),""===a?a=!0:this.options.decodeEntities&&(a=this.entityEncoder.decode(a))}else if(t.attributes.hasOwnProperty(i))break;t.attributes[i]=a;break;case 2:for(let s=0;s<e.length;s++)if(e[s][g]===i){for(t=e[s];e.length>0&&e[0]!==t;)e.shift();e.shift();break}}}else this.addTextNode(e,a,this.lexer.index,!1);this.lexer.getNextChar()}parseText(e){var t=this.lexer.index,i=!1;"SCRIPT"===e[0][g]||"STYLE"===e[0][g]?(this.lexer.goToString("</"+e[0][g],!1),i=!0):this.lexer.goToString("<"),this.addTextNode(e,t,this.lexer.index,i)}addTextNode(e,t,i,s){var r=Ne(ge.TEXT_NODE),n=this.lexer.str.slice(t,i);return null!=s&&(this.options.trimWhitespace?n=n.trim():this.options.collapseWhitespace&&!s&&(n=n.replace(T," ")),this.options.decodeEntities&&!s&&(n=this.entityEncoder.decode(n))),r.nodeValue=n,e[0].childNodes.push(r),D(r,e[0]),r}}class ve{constructor(e,t,i,s){var r,n;const o=e instanceof Uint8ClampedArray?e:null;let a="srgb";if(o?(console.log(`[ImageData] Warning: Array initializer support is experimental! ( new ImageData([${o.length}b ${null!==(n=null===(r=null==o?void 0:o.constructor)||void 0===r?void 0:r.name)&&void 0!==n?n:"Array"}], ${Array.from(arguments).slice(1).join(",")}) )`),this.width=t,this.height="number"==typeof i?i:void 0,a=("object"==typeof i?i:"object"==typeof s?s:{colorSpace:"srgb"}).colorSpace):(this.width=e,this.height=t,a=("object"==typeof i?i:{colorSpace:"srgb"}).colorSpace),"srgb"!==a)throw console.log(`[ImageData] Warning: Only the 'srgb' color space is supported! ( new ImageData(${Array.from(arguments).join(",")}) )`),new Error(`Unsupported colorSpace: ${a}`);if(void 0===this.height&&(this.height=o.length/this.width/4),o){if(this.width*this.height*4!==o.length)throw new Error("The array dimensions do not match the supplied width or height");this.data=new Uint8ClampedArray(o)}else this.data=new Uint8ClampedArray(this.width*this.height*4)}}globalThis&&"object"!=typeof globalThis.ImageData&&(globalThis.ImageData=ve);const Re=Symbol("fill-style");class Le{get fillStyle(){return this[Re]}set fillStyle(e){console.log(`${this}→fillStyle = ${e}`),this[Re]=e}clearRect(e,t,i,s){throw new Error("Not implemented")}fillRect(e,t,i,s){const{r:r,g:n,b:o,a:a}=this.fillStyleRGBA,l=255*a|0,h=this.canvas[Ge];if(0!==e||0!==t||h.length!==i*s*4){for(let a=t;a<t+s;++a){const t=4*a+e+i;for(let i=4*a+e;i<t;++i)h[i+0]=r,h[i+1]=n,h[i+2]=o,h[i+3]=l}console.log(`${this}→fillRect( ${Array.from(arguments).join(", ")} ) with ${r},${n},${o} @ ${l}`)}else{for(let e=0;e<h.length;++e)h[e+0]=r,h[e+1]=n,h[e+2]=o,h[e+3]=l;console.log(`${this}→fillRect( ${Array.from(arguments).join(", ")} ) whole canvas with ${r},${n},${o} @ ${l}`)}}strokeRect(e,t,i,s){throw new Error("Not implemented")}constructor(e){this.canvas=e,this.fillStyle="#000"}drawImage(e,t,i,s,r,n,o,a,l){if(e instanceof globalThis.HTMLCanvasElement){if(s=null!=s?s:e.width,r=null!=r?r:e.height,s!==a||r!==l)return void console.log(`${this} Not implemented: image scaling in drawImage( <${e.constructor.name}> ${Array.from(arguments).join(", ")} )`);const h=e.getContext("2d").getImageData(t,i,s,r),c=h.data,d=this.canvas[Ge],u=r,p=s;for(let e=0;e<u;++e)for(let s=0;s<p;++s){const r=4*((i+e)*h.width+t+s),a=c[r],l=c[r+1],u=c[r+2],p=c[r+3],f=4*((o+e)*h.width+n+s),N=d[f],g=d[f+1],E=d[f+2],T=d[f+3],m=1-p/255;d[f+0]=a*(p/255)+N*(T/255)*m|0,d[f+1]=l*(p/255)+g*(T/255)*m|0,d[f+2]=u*(p/255)+E*(T/255)*m|0,d[f+3]=p+T*m|0}console.log(`${this}→drawImage( <${e.constructor.name}> ${Array.from(arguments).join(", ")} )`)}else console.log(`${this} Not implemented: only canvas sources supported: drawImage( <${e.constructor.name}> ${Array.from(arguments).join(", ")} )`)}createImageData(e,t,i){return e instanceof ve?new ve(e.data,e.width,e.height):new ve(e,t,i)}getImageData(e,t,i,s,r){if(0===e&&0===t&&i===this.canvas.width&&s===this.canvas.height&&!r)return console.log(`${this}→getImageData( ${Array.from(arguments).join(", ")} ) whole canvas ${this.canvas.width}x${this.canvas.height}`),new ve(this.canvas[Ge],this.canvas.width,this.canvas.height);console.log(`${this} Not implemented: context2d.getImageData( ${Array.from(arguments).join(", ")} )`);return new ve(i,s,r)}putImageData(e,t,i,s,r,n,o){let a,l;const h=this.canvas[Ge];if(void 0!==s)console.log(`${this} Not implemented: context2d.putImageData( ${Array.from(arguments).join(", ")} )`);else{if(0===t&&0===i&&e.width===this.canvas.width&&e.height===this.canvas.height){console.log(`${this}→putImageData( ${Array.from(arguments).join(", ")} ) whole canvas ${this.canvas.width}x${this.canvas.height}`);for(let t=0;t<e.height;++t)for(let i=0;i<e.width;++i){const s=4*(t*e.width+i),r=e.data[s+3],n=e.data[s+0],o=e.data[s+1],c=e.data[s+2];0===r&&0!=(n|o|c)&&255!=(n&o&c)?l=!0:r<255&&0!=(n|o|c)&&255!=(n&o&c)&&(a=!0),h[s+0]=n,h[s+1]=o,h[s+2]=c,h[s+3]=r}return a&&console.log(`${this} Compat warning: image contained colored non-opaque pixels (alpha<255), the result be inconsistent with observed browser behavior.`),void(l&&console.log(`${this} Compat warning: image contained fully transparent colored pixels (alpha=0), the result of this operation may differ from browser behavior.`))}console.log(`${this} Not implemented: non-whole-canvas putImageData( ${Array.from(arguments).join(", ")} )`)}}setTransform(e,t,i,s,r,n){console.log(`${this} Not implemented: context2d.setTransform( ${Array.from(arguments).join(", ")} )`)}get[Symbol.toStringTag](){return`${this.canvas[Symbol.toStringTag]}::context2d`}get fillStyleRGBA(){let e;return Ue.has(this.fillStyle)&&(e=Pe(Ue.get(this.fillStyle)),e)?e:(e=Pe(this.fillStyle),e||(e=Pe(this.fillStyle),e||{r:0,g:0,b:0,a:1}))}}const Ue=new Map([["black","#000000"],["silver","#c0c0c0"],["gray","#808080"],["white","#ffffff"],["maroon","#800000"],["red","#ff0000"],["purple","#800080"],["fuchsia","#ff00ff"],["green","#008000"],["lime","#00ff00"],["olive","#808000"],["yellow","#ffff00"],["navy","#000080"],["blue","#0000ff"],["teal","#008080"],["aqua","#00ffff"]]);function Pe(e){var t,i;let s,r,n=0,o=0,a=0,l=0;return s=null===(t=e.match(/^#(?<r>[0-9a-f]{2})(?<g>[0-9a-f]{2})(?<b>[0-9a-f]{2})(?<a>[0-9a-f]{2})?$/))||void 0===t?void 0:t.groups,(null==s?void 0:s.r)&&(null==s?void 0:s.g)&&(null==s?void 0:s.b)&&(n=parseInt(s.r,16),o=parseInt(s.g,16),a=parseInt(s.b,16),l=s.a?parseInt(s.a,10):1,r=!0),s=null===(i=e.match(/^#(?<r>[0-9a-f]{1})(?<g>[0-9a-f]{1})(?<b>[0-9a-f]{1})(?<a>[0-9a-f]{1})?$/))||void 0===i?void 0:i.groups,(null==s?void 0:s.r)&&(null==s?void 0:s.g)&&(null==s?void 0:s.b)&&(n=parseInt(s.r,16),o=parseInt(s.g,16),a=parseInt(s.b,16),l=s.a?parseInt(s.a,10):1,r=!0),r?{r:n,g:o,b:a,a:l}:(console.log(`Not a HTML color string: ${e}`),null)}const ke=Symbol("canvas-width"),$e=Symbol("canvas-height"),je=Symbol("canvas-context"),We=Symbol("element-id"),Ge=Symbol("accesscanvas-data");class Be extends ge{get width(){return console.debug(`${this}→width? (${this[ke]})`),this[ke]}get height(){return console.debug(`${this}→height? (${this[$e]})`),this[$e]}set width(e){console.debug(`${this}→width = ${e}`),this[ke]=e,this.resize(this[ke],this[$e])}set height(e){console.debug(`${this}→height = ${e}`),this[$e]=e,this.resize(this[ke],this[$e])}getContext(e,t){if("2d"!=e)throw new Error(`Not implemented: ${e}`);if(this[je]=this[je]||new Le(this),!(this[je]instanceof Le))throw new Error("Context invalid");return this[je]}toDataURL(e="image/png",t){throw new Error("Not implemented")}toBlob(e,t="image/png",i){throw new Error("Not implemented")}get clientWidth(){return this.width}get clientHeight(){return this.height}constructor(){super(fe),this[We]=(Math.random()*Math.pow(36,6)|0).toString(36),this.resize(300,150)}get[Symbol.toStringTag](){return`HTMLCanvasElement#${this[We]}`}resize(e,t){this[ke]=e,this[$e]=t,this[Ge]=new Uint8ClampedArray(this[ke]*this[$e]*4),console.debug(`${this}→reset, new size: ${this[ke]}x${this[$e]} (${this[Ge].length}b)`)}}globalThis&&"object"!=typeof globalThis.HTMLCanvasElement&&(globalThis.HTMLCanvasElement=Be);const He=/&(#\d+|#[xX][0-9a-fA-F]+|[0-9a-zA-Z]+);?/g,Fe=/[\^$\\.*+?()[\]{}|]/g,Ye=Xe({amp:"&",apos:"'",copy:169,gt:">",lt:"<",nbsp:160,quot:'"'});let Ve=Ye;class ze{constructor(e){this.entities=e||"default"}encode(e,t){return this.encodingReplacements?e.replace(t instanceof RegExp?w(t):this.encodingRE,(e=>this.encodingReplacements[e]||e)):e}decode(e){return this.decodingReplacements?e.replace(He,((e,t)=>"#"===t[0]?(t="x"===t[1]||"X"===t[1]?0|parseInt(t.slice(2),16):0|t.slice(1),String.fromCodePoint(t)):this.decodingReplacements[t]||this.decodingReplacements[t.toLowerCase()]||e)):e}set entities(e){"default"===e?e=Ve:e&&e.encodingRE instanceof RegExp||(e=Xe(e)),this.encodingRE=e.encodingRE,this.encodingReplacements=e.encodingReplacements,this.decodingReplacements=e.decodingReplacements}static set defaultEntities(e){Ve=e&&"object"==typeof e?Xe(Object.assign({},e)):Ye}}function Xe(e){var t={encodingRE:null,encodingReplacements:null,decodingReplacements:null};if(e&&"object"==typeof e){const i={},s={},r=[];for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];if(Number.isFinite(n))n=String.fromCodePoint(n);else if("string"!=typeof n||""===n)continue;r.push(n.replace(Fe,"\\$&")),(!i.hasOwnProperty(n)||t.length+2<i[n].length)&&(i[n]="&"+t+";"),s[t]=n}r.length>0&&(t.encodingRE=new RegExp(r.join("|"),"g"),t.encodingReplacements=i,t.decodingReplacements=s)}return t.encodingRE||(t.encodingRE=new RegExp("(?:)","g")),t}const qe=Symbol("entityEncoder");class Ze extends ge{constructor(e,t){const i=Ne(ge.DOCUMENT_FRAGMENT_NODE,Ze);return i[E]=Me.setupOptions(t),i[qe]=new ze(i[E].entities),i.innerHTML=e,i}get documentElement(){return this[u]||null}get innerHTML(){let e="";for(let t=0;t<this.childNodes.length;t++)e+=ce(this.childNodes[t]);return e}set innerHTML(e){if(this[p]=ge.DOCUMENT_FRAGMENT_NODE,e&&"string"==typeof e){const t=new Me(e,this[E],this[qe]).parseHTML();C(this.childNodes),t.doctype?this[h]=t.doctype:this[h]=null,this.childNodes=t.childNodes;for(let e=0;e<this.childNodes.length;e++)D(this.childNodes[e],this);x(this)}else this.childNodes.length=0}get outerHTML(){return null}set outerHTML(e){}get doctype(){return this[h]||null}set doctype(e){if(e){let t=this[h];e instanceof ge?e.nodeType===ge.DOCUMENT_TYPE_NODE&&e!==t&&(this[h]=e,t?this.replaceChild(e,t):this.insertBefore(e,this.firstChild)):"object"==typeof e&&(t?Je(t,e.name,e.publicId,e.systemId):this[h]=this.insertBefore(this.createDocumentType(e.name,e.publicId,e.systemId),this.firstChild))}else null===e&&this[h]&&(this.removeChild(this[h]),this[h]=null)}get head(){return this[c]||null}get title(){const e=this.head;if(e){const t=e.getElementsByTagName("title");if(t.length>0)return t[0].textContent}return""}set title(e){const t=this.head;if(t){let i=t.getElementsByTagName("title");i=i.length<=0?t.appendChild(this.createElement("title")):i[0],i.textContent=e}}get body(){return this[d]||null}set body(e){e instanceof ge&&e.nodeType===ge.ELEMENT_NODE&&("BODY"===e.tagName||"FRAMESET"===e.tagName)&&e!==this[d]&&this[u]&&(this[d]?this[d].parentNode.replaceChild(e,this[d]):this[u].appendChild(e))}get entityEncoder(){return this[qe]}createElement(e){if(e&&"string"==typeof e){const t=function(e){if("canvas"===e.toLowerCase())return function(e){const t=new Be;switch(t[p]=e,t.nodeValue=null,t[f]=null,t[N]=null,e){case ge.ELEMENT_NODE:t[g]=null,t.attributes={};case ge.DOCUMENT_NODE:case ge.DOCUMENT_FRAGMENT_NODE:t.childNodes=[]}return t}(ge.ELEMENT_NODE);return Ne(ge.ELEMENT_NODE)}(e);return t[g]=e.toUpperCase(),t}}createTextNode(e){return Ke(ge.TEXT_NODE,e)}createComment(e){return Ke(ge.COMMENT_NODE,e)}createCDATASection(e){return Ke(ge.CDATA_SECTION_NODE,e,"]]>")}createProcessingInstruction(e,t){e:if(e&&"string"==typeof e){if(!Me.isNameCharStart(e[0]))break e;for(let t=1;t<e.length;t++)if(!Me.isNameChar(e[t]))break e;const i=Ke(ge.PROCESSING_INSTRUCTION_NODE,t,"?>");return i.target=e,i}throw new Error("Invalid target name "+JSON.stringify(e)+".")}createDocumentType(e,t,i){return Je(Ne(ge.DOCUMENT_TYPE_NODE),e,t,i)}getElementsByName(e){const t=[];return e&&"string"==typeof e&&this.forEach((i=>{i.attributes&&i.attributes.name===e&&t.push(i)})),t}}function Ke(e,t,i=!1){const s=Ne(e);if(s.nodeValue="",t&&"string"==typeof t){if(i&&"string"==typeof i&&-1!==t.indexOf(i))throw new Error("The data provided ('"+t+"') contains '"+i+"'.");s.nodeValue+=t}return s}function Je(e,t,i,s){return t&&"string"==typeof t?(e.name=t.toLowerCase(),e.publicId=i&&"string"==typeof i?i:"",e.systemId=s&&"string"==typeof s?s:""):e.name=e.publicId=e.systemId="",e}return Ze.Node=ge,Ze.EntityEncoder=ze,Ze}();
