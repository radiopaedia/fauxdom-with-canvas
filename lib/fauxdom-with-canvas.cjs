const e={},t={},s=Object.prototype.hasOwnProperty.bind(t),i=null;class r{constructor(e){if(this.index=0,this.str=e,this.scanChar=this.str[this.index],!s(" ")){for(let e=0;e<=32;e++)t[String.fromCharCode(e)]=null;for(let e=128;e<=159;e++)t[String.fromCharCode(e)]=null}}isWhiteSpace(e){return e!==i&&s(e)}goToString(t,s){if(!1!==s)this.index=this.str.indexOf(t,this.index);else{e[t]||(e[t]=new RegExp(t,"ig")),e[t].lastIndex=this.index;const s=e[t].exec(this.str);this.index=s?s.index:-1}this.index>-1?this.scanChar=this.str[this.index]:(this.index=this.str.length,this.scanChar=i)}goToIndex(e){this.scanChar=this.str[this.index=e]}advance(e){return this.index+=e,this.index>this.str.length?(this.index=this.str.length,this.scanChar=i):this.scanChar=this.str[this.index]}match(e,t){var s=this.str.substr(this.index,e.length);return!1===t&&(e=e.toLowerCase(),s=s.toLowerCase()),s===e&&(this.index+=e.length-1,this.getNextChar(),!0)}peek(){return this.str[this.index+1]}getChar(){return this.scanChar}getNextChar(){return this.index+1<this.str.length?this.scanChar=this.str[++this.index]:(this.index=this.str.length,this.scanChar=i)}getNextAfterWhiteSpace(){var e;do{e=this.getNextChar()}while(e!==i&&s(e));return e}skipWhiteSpace(){for(var e=this.scanChar;e!==i&&s(e);)e=this.getNextChar();return this.scanChar}}const n=Symbol("event-listeners");class o{addEventListener(e,t,s){this[n]=this[n]??new Map;let i=this[n].get(e);i||(i=[],this[n].set(e,i)),i.push({callback:t,capturing:!0===s||!!s?.capture,options:"object"==typeof s?s:{capture:!!s}})}removeEventListener(e,t,s){if(!this[n])return;let i=this[n].get(e);if(!i)return;const r=!!("object"==typeof s?s.capture:s);i.map(((e,s)=>e.callback===t&&e.capturing===r?s:void 0)).reverse().forEach((e=>{void 0!==e&&i.splice(e,1)}))}dispatchEvent(e){let t=!0;if(!this[n])return t;const s=this[n].get(e.type)??[];return s?.forEach((({callback:s})=>{s(e),e.defaultPrevented&&(t=!1)})),t}}const a=Symbol("doctype"),l=Symbol("head"),h=Symbol("body"),c=Symbol("documentElement"),d=Symbol("nodeType"),u=Symbol("parentNode"),p=Symbol("ownerDocument"),N=Symbol("tagName"),f=Symbol("parserOptions"),g=/\s+/g,E={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11},T={AREA:!0,BASE:!0,BR:!0,COL:!0,COMMAND:!0,EMBED:!0,HR:!0,IMG:!0,INPUT:!0,KEYGEN:!0,LINK:!0,META:!0,PARAM:!0,SOURCE:!0,TRACK:!0,WBR:!0};function m(e){var t=-1,s=-1,i="HTML";e[a]&&e[f].allowCustomRootElement&&(i=e[a].name.toUpperCase());for(let r=0,n=e.childNodes.length;r<n;r++){if(e.childNodes[r].tagName===i){s=r,e[d]=E.DOCUMENT_NODE,e[c]=e.childNodes[r],e[l]=e[h]=null;for(let t=0;t<e[c].childNodes.length;t++){const s=e[c].childNodes[t];switch(s.tagName){case"HEAD":e[l]=s;break;case"BODY":case"FRAMESET":e[h]=s}if(e[l]&&e[h])break}if(-1!==t){const i=e[l]||e[h]||e[c],r=s-t;for(let r=t;r<s;r++)y(e.childNodes[r],i);i.childNodes.splice(0,0,...e.childNodes.splice(t,r)),s-=r,n-=r}if(s<n-1){const t=e[h]||e[l]||e[c];for(let i=s+1;i<n;i++)y(e.childNodes[i],t);t.childNodes.splice(t.childNodes.length,0,...e.childNodes.splice(s+1))}break}-1===t&&e.childNodes[r].nodeType===E.ELEMENT_NODE&&(t=r)}}function O(e){const t=e[p]||e.getRootNode();return t[d]===E.DOCUMENT_NODE||t[d]===E.DOCUMENT_FRAGMENT_NODE?t:null}function x(e){if(e&&e.length>0)for(let t=0;t<e.length;t++)y(e[t],null)}function y(e,t){const s=null!==t?O(t):null;e[p]!==s&&e.hasChildNodes()&&e.forEach((e=>{e[p]=s}),null),e[u]=t,e[p]=s}function C(e){if(!e.global){let t=e.flags;e=new RegExp(e.source,t+"g")}return e}const b=Symbol("element"),D=Symbol("length"),w=/^\S+$/,S=Array.prototype.indexOf,_=Array.prototype.join,A=Array.prototype.splice;class I{constructor(){throw new Error("Cannot directly instantiate DOMTokenList.")}get length(){return this[D]}set length(e){}get value(){return _.call(this," ")}set value(e){if(this[D]>0)for(let e in this)this.hasOwnProperty(e)&&isFinite(e)&&delete this[e];this[D]=0,"string"==typeof e?this.add.apply(this,e.split(g)):delete this[b].attributes.class}add(){for(let e=0;e<arguments.length;e++)-1===S.call(this,arguments[e])&&this.supports(arguments[e])&&(this[this[D]++]=arguments[e]);this[b].attributes.class=this.value}remove(){for(let e,t=0;t<arguments.length;t++)e=S.call(this,arguments[t]),-1!==e&&(A.call(this,e,1),this[D]--);this[b].attributes.class=this.value}item(e){if("number"==typeof e&&e>=0&&e<this[D])return this[e]}toggle(e,t){var s=!1;if(this.supports(e)){let i=S.call(this,e);-1!==i&&!0!==t?(A.call(this,i,1),this[D]--):!1!==t&&(s=!0,-1===i&&(this[this[D]++]=e)),this[b].attributes.class=this.value}return s}contains(e){return-1!==S.call(this,e)}replace(e,t){var s=S.call(this,e);return!!(s>=0&&this.supports(t))&&(-1===S.call(this,t)?this[s]=t:(A.call(this,s,1),this[D]--),this[b].attributes.class=this.value,!0)}supports(e){return!(!e||"string"!=typeof e)&&e.match(w)}}const M=Symbol("element");function v(e){return e.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))}function R(e){return"string"==typeof e&&(!!e.match(/^\-?[a-z_-]*[a-z]$/)||(!!e.match(/^\-\-[A-Za-z_-]*[A-Za-z0-9]$/)||!!e.match(/^[a-zA-Z]+$/)))}function L(e=""){return new Map(e.split(/\s*;\s*/g).filter((e=>e.length)).map((e=>e.trim().match(/^([a-z-]+)\s*:\s*(.*)$/).slice(1))))}function U(e){return Array.from(e?.entries()??[]).map((e=>e.join(": "))).join("; ")}function k(e){return new Proxy({[M]:e},{get(t,s){if(s===M)return e;if(!R(s))return;const i=v(s);return L(e.attributes.style).get(i)},set(t,s,i){if(!R(s))return!0;const r=v(s),n=L(e.attributes.style);return e.attributes.style=U(n.set(r,i)),!0},deleteProperty(t,s){if(!R(s))return;const i=v(s),r=L(e.attributes.style);e.attributes.style=U(r.delete(i))}})}const P=/\r\n|\r|\f/g,$=/\(\s*(even|odd|(?:(?:([+-]?\d*)n)\s*(?:([+-])\s*(\d+))?|([+-]?\d+)))\s*/g,W={Selectors:0,Identifier:1,Iterator:2,IteratorOf:3},G={is:W.Selectors,not:W.Selectors,where:W.Selectors,has:W.Selectors,lang:W.Identifier,dir:W.Identifier,"nth-child":W.IteratorOf,"nth-last-child":W.IteratorOf,"nth-of-type":W.Iterator,"nth-last-of-type":W.Iterator,"nth-col":W.Iterator,"nth-last-col":W.Iterator};function j(e){return B(new r(e.replace(P,"\n")))}function B(e,t=i,s=!1){for(var r=e.skipWhiteSpace(),n={},o=[],a=[o],l=[a];r!==i&&r!==t;){switch(r){case"*":if(o.length>0)throw H("Universal selectors must come before all other simple selectors.",e);n.type="universal",o.push(n),n={};break;case"#":case".":{e.getNextChar();const t=F(e);if(!t)throw H("Expected an identifier.",e);n.type="#"===r?"id":"class",n.name=t,o.push(n),n={};break}case"[":{e.getNextAfterWhiteSpace();const t=F(e);if(!t)throw H("Expected an identifier.",e);if(n.type="attr",n.name=t,n.comparison="=",n.value=!0,n.ignoreCase=!1,"]"!==(r=e.getNextAfterWhiteSpace())){switch(r){case"=":break;case"~":case"|":case"^":case"$":case"*":if("="!==e.peek())throw H("Expected '='.",e,1);n.comparison=r+n.comparison,e.getNextChar();break;default:throw H("Unexpected character '"+(r===i?"END_OF_INPUT":r)+"'.",e)}if("'"===(r=e.getNextAfterWhiteSpace())||'"'===r){const t=r;for(n.value="",r=e.getNextChar();r!==i&&r!==t&&"\n"!==r;)"\\"===r?(n.value+=Y(e),r=e.getChar()):(n.value+=r,r=e.getNextChar())}else{const t=F(e);if(!t)throw H("Expected an identifier.",e);n.value=t}if("]"!==e.getNextAfterWhiteSpace()){const t=F(e);if("i"===t||"I"===t)n.ignoreCase=!0;else if("s"===t||"S"===t)n.ignoreCase=!1;else if(t)throw H("Unexpected identifier '"+t+"'.",e,1-t.length);if("]"!==e.getNextAfterWhiteSpace())throw H("Expected ']'.",e,-1+t.length)}}o.push(n),n={};break}case":":if(e.getNextChar(),e.match(":")){const t=F(e);if(!t)throw H("Expected a pseudo-element name.",e);n.type="pseudo-element",n.name=t}else{const t=F(e);if(!t)throw H("Expected a pseudo-class name.",e);n.type="pseudo-class",n.name=t;const s=G[t];if(null!=s){if(n.type="pseudo-fn","("!==e.getNextChar())throw H("Expected '('.",e);switch(s){case W.IteratorOf:case W.Iterator:let t,i=0,r=0;$.lastIndex=e.index;const o=$.exec(e.str);if(!o)throw H("Invalid parameter.",e,1);if(e.advance(o[0].length),s===W.IteratorOf){e.skipWhiteSpace();const s=e.index;if("of"===F(e).toLowerCase()){const s=e.getNextChar();if(")"!==s&&!e.isWhiteSpace(s))throw H("Expected whitespace.",e);if(t=B(e,")"),!(t instanceof Array)||0===t.length)throw H("Expected at least one selector.",e)}else e.goToIndex(s)}if(")"!==e.skipWhiteSpace())throw H("Expected ')'.",e);"even"===o[1]||"odd"===o[1]?(i=2,"odd"===o[1]&&(r=1)):o[5]?r=parseInt(o[5],10):(i="-"===o[2]?-1:o[2]&&"+"!==o[2]?parseInt(o[2],10):1,o[3]&&(r=parseInt(o[3]+o[4],10))),n.params=[i,r],t&&n.params.push(t);break;case W.Selectors:if(e.getNextChar(),n.params=B(e,")",!0),0===n.params.length)throw H("Expected at least one selector.",e);break;case W.Identifier:if(!X(e.getNextAfterWhiteSpace()))throw H("Expected an identifier.",e);n.params=[F(e)],e.getNextChar()}if(")"!==e.skipWhiteSpace())throw H("Expected ')'.",e)}else"before"!==t&&"after"!==t&&"first-line"!==t&&"first-letter"!==t||(n.type="pseudo-element")}o.push(n),n={};break;case"+":case">":case"~":if(0===o.length){if(1===a.length){if(!s)throw H("Absolute selectors cannot start with a combinator.",e);a.unshift([{type:"pseudo-class",name:"scope"}])}else if("string"==typeof a[a.length-2])throw H("Cannot have multiple combinators in a row.",e);a.splice(a.length-1,0,r)}else a.push(r,o=[]);break;case",":if(0===o.length){if(a.length>1){if(a.pop(),"string"==typeof a[a.length-1])throw H("Complex selectors are not allowed to end with a combinator.",e,-1);l.push(a=[o])}}else l.push(a=[o=[]]);e.skipWhiteSpace();break;default:if(e.isWhiteSpace(r))o.length>0&&a.push(o=[]),e.skipWhiteSpace(),e.advance(-1);else{if(!X(r))throw H("Unexpected character '"+r+"'.",e);if(o.length>0)throw H("Type (tag name) selectors must come before all other simple selectors.",e);n.type="type",n.name=F(e).toUpperCase(),o.push(n),n={}}}r=e.getNextChar()}if(0===o.length&&(1===a.length?(l.pop(),a=l[l.length-1]):a.pop()),a&&"string"==typeof a[a.length-1])throw H("Complex selectors are not allowed to end with a combinator.",e,-1);return l}function H(e,t,s=0){var i=new SyntaxError(e),r=t.index+s;return i.stack="SyntaxError: "+e+"\n\n"+t.str+"\n"+" ".repeat(r)+"^\n    at index "+r,i}function F(e){var t="",s=e.getChar();if(X(s)){do{"\\"===s?(t+=Y(e),s=e.getChar()):(t+=s,s=e.getNextChar())}while(s!==i&&(X(s)||s>="0"&&s<="9"||"-"===s));e.advance(-1)}return t}function Y(e){var t=e.getNextChar();if(V(t)){let s="";for(let i=5;i>=0&&V(t);i--)s+=t,t=e.getNextChar();return e.isWhiteSpace(t)&&e.getNextChar(),s=0|parseInt(s,16),0===s||s>=55296&&s<=57343||s>1114111?"�":String.fromCodePoint(s)}return t===i?"�":(e.getNextChar(),t)}function V(e){return e!==i&&(e>="0"&&e<="9"||e>="A"&&e<="F"||e>="a"&&e<="f")}function X(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"||"_"===e||e>=""||"\\"===e}const z=0,q=1,Z=2,K=3,J=4,Q={">":Z,"+":K,"~":J},ee={is:(e,t,s)=>ie(e,t,s),not:(e,t,s)=>!ie(e,t,s),has(e,t,s){var i=!1;for(let e=0;e<s.length;e++)if(s[e][0]instanceof Array&&ne(s[e][0][0])){i=ie(t,t,s,!0);break}return!i&&t.childNodes.length>0&&t.forEach((e=>{if(ie(t,e,s))return i=!0,!1})),i},"nth-child"(e,t,s){const i=t[u],r=i.childNodes,n=new oe(s[0],s[1]);for(let e=0;e<r.length;e++)if(r[e][d]===pe.ELEMENT_NODE&&(!s[2]||ie(i,r[e],s[2]))){const s=n.next();if(r[e]===t)return s}return!1},"nth-last-child"(e,t,s){const i=t[u],r=i.childNodes,n=new oe(s[0],s[1]);for(let e=r.length-1;e>=0;e--)if(r[e][d]===pe.ELEMENT_NODE&&(!s[2]||ie(i,r[e],s[2]))){const s=n.next();if(r[e]===t)return s}return!1},"nth-of-type"(e,t,s){const i=t[u].childNodes,r=new oe(s[0],s[1]),n=t[N];for(let e=0;e<i.length;e++)if(i[e][N]===n){const s=r.next();if(i[e]===t)return s}},"nth-last-of-type"(e,t,s){const i=t[u].childNodes,r=new oe(s[0],s[1]),n=t[N];for(let e=i.length-1;e>=0;e--)if(i[e][N]===n){const s=r.next();if(i[e]===t)return s}}},te={scope:(e,t)=>t===e,enabled(e,t){switch(t[N]){case"BUTTON":case"INPUT":case"SELECT":case"TEXTAREA":case"OPTGROUP":case"OPTION":case"FIELDSET":return!t.hasAttribute("disabled")}return!1},disabled(e,t){switch(t[N]){case"BUTTON":case"INPUT":case"SELECT":case"TEXTAREA":case"OPTGROUP":case"OPTION":case"FIELDSET":return t.hasAttribute("disabled")}return!1},checked(e,t){if("INPUT"===t[N]){const e=t.getAttribute("type");if("checkbox"===e||"radio"===e)return t.hasAttribute("checked")}else if("OPTION"===t[N])return t.hasAttribute("selected");return!1},required(e,t){switch(t[N]){case"INPUT":case"SELECT":case"TEXTAREA":return t.hasAttribute("required")}return!1},optional(e,t){switch(t[N]){case"INPUT":case"SELECT":case"TEXTAREA":return!t.hasAttribute("required")}return!1},root(e,t){const s=O(e);return!!s&&s.documentElement===t},empty:(e,t)=>0===t.childNodes.length,"first-child"(e,t){const s=t[u].childNodes;for(let e=0;e<s.length;e++)if(s[e][d]===pe.ELEMENT_NODE)return s[e]===t},"last-child"(e,t){const s=t[u].childNodes;for(let e=s.length-1;e>=0;e--)if(s[e][d]===pe.ELEMENT_NODE)return s[e]===t},"only-child"(e,t){const s=t[u].childNodes;let i,r;for(let e=0,t=s.length-1;t>=0&&(!i||!r);e++,t--)i||s[e][d]!==pe.ELEMENT_NODE||(i=s[e]),r||s[t][d]!==pe.ELEMENT_NODE||(r=s[t]);return i===r&&i===t},"first-of-type"(e,t){const s=t[u].childNodes,i=t[N];for(let e=0;e<s.length;e++)if(s[e][N]===i)return s[e]===t},"last-of-type"(e,t){const s=t[u].childNodes,i=t[N];for(let e=s.length-1;e>=0;e--)if(s[e][N]===i)return s[e]===t},"only-of-type"(e,t){const s=t[u].childNodes,i=t[N];let r,n;for(let e=0,t=s.length-1;t>=0&&(!r||!n);e++,t--)r||s[e][N]!==i||(r=s[e]),n||s[t][N]!==i||(n=s[t]);return r===n&&r===t}};function se(e,t,s){const i=j(t),r=[];return e.forEach((t=>{if(ie(e,t,i)&&(r.push(t),!s))return!1})),s?r:r[0]||null}function ie(e,t,s,i=!1){var r;e:for(let n=0;n<s.length;n++){const o=s[n];let a=z;if(!(i&&o[0]instanceof Array)||ne(o[0][0])){r=t;t:for(let t=i?0:o.length-1;i?t<o.length:t>=0;i?t++:t--)if(Q.hasOwnProperty(o[t]))a=Q[o[t]];else switch(a){case z:if(!re(e,r,o[t]))continue e;a=q;break;case q:for(;r=r[u];)if(re(e,r,o[t]))continue t;continue e;case Z:if(!re(e,r=r[u],o[t]))continue e;break;case K:{const s=r[u].childNodes;if(!re(e,r=s[s.indexOf(r)+(i?1:-1)],o[t]))continue e;break}case J:{const s=r[u].childNodes;for(let n=s.indexOf(r)+(i?1:-1);i?n<s.length:n>=0;i?n++:n--)if(re(e,s[n],o[t])){r=s[n];continue t}continue e}}return!0}}return!1}function re(e,t,s){if(!t||t[d]!==pe.ELEMENT_NODE)return!1;for(let i=0;i<s.length;i++){const r=s[i];let n;switch(n=!1,r.type){case"universal":return!0;case"type":n=t[N]===r.name;break;case"id":n=t.id===r.name;break;case"class":n=t.classList.contains(r.name);break;case"attr":if("="!==r.comparison||!0!==r.value&&""!==r.value){let e=t.getAttribute(r.name);if("string"==typeof e){let t=r.ignoreCase?r.value.toLowerCase():r.value;if(r.ignoreCase&&(e=e.toLowerCase()),""!==t)switch(r.comparison){case"=":n=e===t;break;case"~=":n=-1!==e.split(g).indexOf(t);break;case"|=":n=e===t||e.startsWith(t+"-");break;case"^=":n=e.startsWith(t);break;case"$=":n=e.endsWith(t);break;case"*=":n=-1!==e.indexOf(t)}}}else n=t.hasAttribute(r.name);break;case"pseudo-element":break;case"pseudo-class":te.hasOwnProperty(r.name)&&(n=!!te[r.name].call(null,e,t));break;case"pseudo-fn":ee.hasOwnProperty(r.name)&&(n=!!ee[r.name].call(null,e,t,r.params))}if(!n)return!1}return!0}function ne(e){return!!e&&"pseudo-class"===e.type&&"scope"===e.name}ee.where=ee.is;class oe{constructor(e,t){this.A=0|parseInt(e,10),this.B=0|parseInt(t,10),this.current=0}next(){if(0===this.A&&0===this.B)return!1;this.current+=1;let e=!1;return 0===this.A?e=this.current===this.B:(this.A<0&&this.B>=this.current||this.A>0&&this.current>=this.B)&&(e=(this.current+this.B)%this.A==0),e}}function ae(e){var t=e.tagName,s=O(e),i=s?s.entityEncoder:null,r="";switch(e.nodeType){case E.ELEMENT_NODE:r+="<"+(t=t.toLowerCase());for(let t in e.attributes)if(e.attributes.hasOwnProperty(t)){let n=e.attributes[t];!0===n?n="":i&&s[f]&&(n=le(n,i,s[f])),r+=" "+t,""!==n&&(r+='="'+n+'"')}r+=">";for(let t=0;t<e.childNodes.length;t++)r+=ae(e.childNodes[t]);!0!==T[e.tagName]&&(r+="</"+t+">");break;case E.TEXT_NODE:i&&s[f]&&(!e.parentNode||"SCRIPT"!==e.parentNode.tagName&&"STYLE"!==e.parentNode.tagName)?r+=le(e.nodeValue,i,s[f]):r+=e.nodeValue;break;case E.CDATA_SECTION_NODE:r+="<![CDATA["+e.nodeValue+"]]>";break;case E.PROCESSING_INSTRUCTION_NODE:r+="<?"+e.nodeName,e.nodeValue&&(r+=" "+e.nodeValue),r+="?>";break;case E.COMMENT_NODE:r+="\x3c!--"+e.nodeValue+"--\x3e";break;case E.DOCUMENT_TYPE_NODE:r+="<!DOCTYPE",e.name&&(r+=" "+e.name),e.publicId&&(r+=' PUBLIC "'+e.publicId+'"'),e.systemId&&(e.publicId||(r+=" SYSTEM"),r+=' "'+e.systemId+'"'),r+=">"}return r}function le(e,t,s){return!1===s.encodeEntities?e:!0!==s.encodeEntities&&s.encodeEntities instanceof RegExp?t.encode(e,s.encodeEntities):t.encode(e)}const he=Symbol("classList"),ce=Symbol("style"),de=Symbol("extendNode");function ue(e,t=pe){const s=Object.create(t.prototype);switch(s[d]=e,s.nodeValue=null,s[u]=null,s[p]=null,e){case pe.ELEMENT_NODE:s[N]=null,s.attributes={};case pe.DOCUMENT_NODE:case pe.DOCUMENT_FRAGMENT_NODE:s.childNodes=[]}return s}class pe extends o{constructor(){if(super(),arguments[0]!==de)throw new Error("Cannot directly instantiate Node.")}get nodeType(){return this[d]}get nodeName(){switch(this.nodeType){case pe.ELEMENT_NODE:return this.tagName;case pe.TEXT_NODE:return"#text";case pe.CDATA_SECTION_NODE:return"#cdata-section";case pe.PROCESSING_INSTRUCTION_NODE:return this.target;case pe.COMMENT_NODE:return"#comment";case pe.DOCUMENT_NODE:return"#document";case pe.DOCUMENT_TYPE_NODE:return this.name;case pe.DOCUMENT_FRAGMENT_NODE:return"#document-fragment"}}get parentNode(){return this[u]}get ownerDocument(){return this[p]}get tagName(){return this[N]||null}get firstChild(){return this.childNodes&&this.childNodes[0]||null}get lastChild(){return this.childNodes&&this.childNodes[this.childNodes.length-1]||null}get previousSibling(){const e=this.parentNode;if(e){const t=e.childNodes.indexOf(this);if(t>0)return e.childNodes[t-1]}return null}get nextSibling(){const e=this.parentNode;if(e){const t=e.childNodes.indexOf(this);if(t>-1&&t<e.childNodes.length-1)return e.childNodes[t+1]}return null}get id(){return this.attributes&&this.attributes.id||""}set id(e){this.attributes&&(this.attributes.id=e)}get className(){return this.attributes&&this.attributes.class||""}set className(e){this.attributes&&(this.classList.value=e,this.attributes.class=this[he].value)}get classList(){return this.attributes?(this[he]||(this[he]=function(e){const t=Object.create(I.prototype);t[D]=0,t[b]=e;const s=e.className;return s&&(t.value=s),t}(this)),this[he]):null}get innerHTML(){if(this.nodeType===pe.ELEMENT_NODE){let e="";for(let t=0;t<this.childNodes.length;t++)e+=ae(this.childNodes[t]);return e}return null}set innerHTML(e){if(this.nodeType===pe.ELEMENT_NODE&&!0!==T[this.tagName]){const t=ge(this,e);t?fe(this,t,0,this.childNodes.length):(x(this.childNodes),this.childNodes.length=0)}}get outerHTML(){return ae(this)}set outerHTML(e){if(this.parentNode){const t=this.parentNode.childNodes.indexOf(this),s=ge(this,e);s?fe(this.parentNode,s,t,1):x(this.parentNode.childNodes.splice(t,1))}}get style(){return this.attributes?(this[ce]||(this[ce]=k(this)),this[ce]):null}set style(e){this.attributes&&(this[ce]||(this[ce]=k(this)),function(e,t){const s=U(L(t));e[M].attributes.style=s}(this[ce],e))}get textContent(){if(this.childNodes){let e="";for(let t=0;t<this.childNodes.length;t++)this.childNodes[t].nodeType!==pe.COMMENT_NODE&&this.childNodes[t].nodeType!==pe.CDATA_SECTION_NODE&&this.childNodes[t].nodeType!==pe.PROCESSING_INSTRUCTION_NODE&&(e+=this.childNodes[t].textContent);return e}return this.nodeValue}set textContent(e){if(null==e?e="":"string"!=typeof e&&(e+=""),this.childNodes){let t=ue(pe.TEXT_NODE);t.nodeValue=e,y(t,this),x(this.childNodes),this.childNodes.length=1,this.childNodes[0]=t}else this.nodeType>=pe.TEXT_NODE&&this.nodeType<=pe.COMMENT_NODE&&(this.nodeValue=e)}getRootNode(){let e=this;for(;e.parentNode;)e=e.parentNode;return e}hasAttributes(){if(this.attributes)for(let e in this.attributes)if(this.attributes.hasOwnProperty(e))return!0;return!1}getAttributeNames(){return this.attributes?Object.keys(this.attributes):[]}getAttribute(e){var t;return this.attributes&&e&&"string"==typeof e&&(t=this.attributes[Ee(this,e)]),void 0===t?null:t}setAttribute(e,t){this.attributes&&e&&"string"==typeof e&&("class"===(e=Ee(this,e))?!0!==t?this.className=""+t:(this.classList.value="",this.attributes[e]=!0):this.attributes[e]="string"==typeof t||!0===t?t:""+t)}toggleAttribute(e,t){if(this.attributes&&e&&"string"==typeof e)return e=Ee(this,e),this.attributes.hasOwnProperty(e)?1!==arguments.length&&!1!==t||(delete this.attributes[e],!1):(1===arguments.length||!0===t)&&(this.attributes[e]=!0)}removeAttribute(e){this.attributes&&e&&"string"==typeof e&&("class"===(e=Ee(this,e))&&this[he]&&(this[he].value=null),delete this.attributes[e])}hasAttribute(e){return!(!this.attributes||!e||"string"!=typeof e)&&this.attributes.hasOwnProperty(Ee(this,e))}hasChildNodes(){return!!this.childNodes&&this.childNodes.length>0}appendChild(e){return this.insertBefore(e,null)}insertBefore(e,t){if(this.childNodes&&e instanceof pe&&arguments.length>1){let s=-1;if(null==t?s=this.childNodes.length:t instanceof pe&&t.parentNode===this&&(s=this.childNodes.indexOf(t)),-1!==s)return fe(this,e,s)}return null}replaceChild(e,t){return this.childNodes&&t instanceof pe&&e instanceof pe&&t.parentNode===this&&t!==e?(fe(this,e,this.childNodes.indexOf(t),1),t):null}removeChild(e){if(this.childNodes&&e instanceof pe&&e.parentNode===this){const t=this.childNodes.indexOf(e),s=O(this);return s&&e.parentNode===s.documentElement&&Ne.hasOwnProperty(e.tagName)&&(s[Ne[e.tagName]]=null),x(this.childNodes.splice(t,1)),e}return null}cloneNode(e){var t;switch(t=this.nodeType===pe.DOCUMENT_NODE||this.nodeType===pe.DOCUMENT_FRAGMENT_NODE?new Xe(null,this[f]):ue(this.nodeType),this.nodeType){case pe.ELEMENT_NODE:t[N]=this.tagName,t.attributes=Object.assign(t.attributes,this.attributes);break;case pe.TEXT_NODE:case pe.CDATA_SECTION_NODE:case pe.PROCESSING_INSTRUCTION_NODE:case pe.COMMENT_NODE:t.nodeValue=this.nodeValue;break;case pe.DOCUMENT_NODE:case pe.DOCUMENT_FRAGMENT_NODE:t[d]=this.nodeType,t.entityEncoder.entities=this.entityEncoder;break;case pe.DOCUMENT_TYPE_NODE:t.name=this.name,t.publicId=this.publicId,t.systemId=this.systemId}if(!0===e&&this.childNodes&&this.childNodes.length>0){for(let e=0;e<this.childNodes.length;e++)t.appendChild(this.childNodes[e].cloneNode(!0));t.nodeType!==pe.DOCUMENT_NODE&&t.nodeType!==pe.DOCUMENT_FRAGMENT_NODE||m(t)}return t}getElementById(e){var t=null;return e&&"string"==typeof e&&this.childNodes&&this.forEach((s=>{if(s.id===e)return t=s,!1})),t}getElementsByClassName(e){var t=[];if(e&&"string"==typeof e){const s=e.trim().split(g);(s.length>1||""!==s[0])&&this.forEach((e=>{for(let t=0;t<s.length;t++)if(!e.classList.contains(s[t]))return;t.push(e)}))}return t}getElementsByTagName(e){var t=[];return e&&"string"==typeof e&&(e=e.toUpperCase(),this.forEach((s=>{"*"!==e&&s.tagName!==e||t.push(s)}))),t}closest(e){return e&&"string"==typeof e?function(e,t){const s=j(t);let i=e;for(;null!=i&&i[d]===pe.ELEMENT_NODE;){if(ie(e,i,s))return i;i=i[u]}return null}(this,e):null}matches(e){return!(!e||"string"!=typeof e)&&function(e,t){return ie(e,e,j(t))}(this,e)}querySelector(e){return e&&"string"==typeof e?se(this,e,!1):null}querySelectorAll(e){return e&&"string"==typeof e?se(this,e,!0):[]}forEach(e,t=E.ELEMENT_NODE){let s,i,r=this.childNodes,n=this.firstChild,o=[],a=0;for(;n;){if(s=n[u],i=r[a+1],(null===t||n.nodeType===t)&&!1===e(n,s))return;if(n[u]===s&&n.childNodes&&n.childNodes.length>0)o.push(a),r=n.childNodes,n=r[a=0];else{for(i?(a+=1,i!==r[a]&&(a=s.childNodes.indexOf(i))):a=r.length;null==r[a];){if(n=s,s=n[u],!n||n===this)return;r=s.childNodes,a=o.pop()+1}n=r[a]}}}}Object.defineProperties(pe,{ELEMENT_NODE:{value:E.ELEMENT_NODE},TEXT_NODE:{value:E.TEXT_NODE},CDATA_SECTION_NODE:{value:E.CDATA_SECTION_NODE},PROCESSING_INSTRUCTION_NODE:{value:E.PROCESSING_INSTRUCTION_NODE},COMMENT_NODE:{value:E.COMMENT_NODE},DOCUMENT_NODE:{value:E.DOCUMENT_NODE},DOCUMENT_TYPE_NODE:{value:E.DOCUMENT_TYPE_NODE},DOCUMENT_FRAGMENT_NODE:{value:E.DOCUMENT_FRAGMENT_NODE}});const Ne={HEAD:l,BODY:h,FRAMESET:h};function fe(e,t,s,i=0){if(!e||e.nodeType!==pe.ELEMENT_NODE&&e.nodeType!==pe.DOCUMENT_NODE&&e.nodeType!==pe.DOCUMENT_FRAGMENT_NODE||e.nodeType===pe.ELEMENT_NODE&&!0===T[e.tagName])return t;if(t.nodeType<=pe.COMMENT_NODE){if(e.parentNode&&e.parentNode.nodeType===pe.DOCUMENT_NODE&&Ne.hasOwnProperty(t.tagName)){const s=Ne[t.tagName];if(e.parentNode[s]&&0===i)return t;e.parentNode[s]=t}t.parentNode&&t.parentNode.removeChild(t),y(t,e),x(e.childNodes.splice(s,i,t))}else if(t.nodeType!==pe.DOCUMENT_TYPE_NODE||e.nodeType!==pe.DOCUMENT_NODE&&e.nodeType!==pe.DOCUMENT_FRAGMENT_NODE){if(t.nodeType===pe.DOCUMENT_FRAGMENT_NODE)if(e.parentNode&&e.parentNode.nodeType===pe.DOCUMENT_NODE){i>0&&x(e.childNodes.splice(s,i));for(let r=t.childNodes.length-1;r>=0;r--){const n=t.childNodes[r];if(Ne.hasOwnProperty(n.tagName)){const t=Ne[n.tagName];if(e.parentNode[t]&&0===i)continue;e.parentNode[t]=n}y(n,e),e.childNodes.splice(s,0,n),t.childNodes.splice(r,1)}}else if(t!==O(e)){for(let s=0;s<t.childNodes.length;s++)y(t.childNodes[s],e);x(e.childNodes.splice(s,i,...t.childNodes)),t.childNodes.length=0}}else{const r=t.parentNode;!r||r.nodeType!==pe.DOCUMENT_NODE&&r.nodeType!==pe.DOCUMENT_FRAGMENT_NODE||(r.removeChild(t),r[a]=null),y(t,e),x(e.childNodes.splice(s,i,t)),e[a]=t}return t}function ge(e,t){if(t&&"string"==typeof t){const s=O(e);return new _e(t,s?s[f]:null,s?s.entityEncoder:null).parseHTML()}}function Ee(e,t){const s=O(e);return s&&s[f].lowerAttributeCase?t.toLowerCase():t}const Te=String.prototype.toLowerCase,me=String.prototype.toUpperCase,Oe={allowCustomRootElement:!1,allowSelfClosingSyntax:!1,allowCDATA:!1,allowProcessingInstructions:!1,decodeEntities:!1,encodeEntities:!1,collapseWhitespace:!1,trimWhitespace:!1,lowerAttributeCase:!1},xe={">":!0,"/":!0,"=":!0},ye={P:!0},Ce={DT:!0,DD:!0},be={TBODY:!0,THEAD:!0,TFOOT:!0},De={TD:!0,TH:!0},we={BUTTON:!0,DATALIST:!0,OPTGROUP:!0,OPTION:!0,PROGRESS:!0,SELECT:!0,TEXTAREA:!0},Se={ADDRESS:ye,ARTICLE:ye,ASIDE:ye,BLOCKQUOTE:ye,DIV:ye,FIELDSET:ye,FOOTER:ye,H1:ye,H2:ye,H3:ye,H4:ye,H5:ye,H6:ye,HEADER:ye,HGROUP:ye,HR:ye,MAIN:ye,NAV:ye,P:ye,PRE:ye,SECTION:ye,BODY:{HEAD:!0,TITLE:!0},DL:ye,DD:Ce,DT:Ce,TABLE:ye,TBODY:be,THEAD:be,TD:De,TFOOT:be,TH:De,TR:{TR:!0},LI:{LI:!0},OL:ye,UL:ye,BUTTON:we,DATALIST:we,FORM:ye,INPUT:we,OPTGROUP:{OPTGROUP:!0,OPTION:!0},OPTION:{OPTION:!0},OUTPUT:we,PROGRESS:we,SELECT:we,TEXTAREA:we};class _e{constructor(e,t,s){this.options=_e.setupOptions(t),this.lexer=new r(e),this.entityEncoder=s}static setupOptions(e){return(e=Object.assign({},Oe,e)).encodeEntities instanceof RegExp&&(e.encodeEntities=C(e.encodeEntities)),Object.freeze(e)}static isNameCharStart(e){return":"===e||"_"===e||e>="A"&&e<="Z"||e>="a"&&e<="z"||e>="À"&&e<="Ö"||e>="Ø"&&e<="ö"||e>="ø"&&e<="˿"||e>="Ͱ"&&e<="ͽ"||e>="Ϳ"&&e<="῿"||"‌"===e||"‍"===e||e>="⁰"&&e<="↏"||e>="Ⰰ"&&e<="⿯"||e>="、"&&e<="퟿"||e>="豈"&&e<="﷏"||e>="ﷰ"&&e<="�"||e>="က0"&&e<="F"}static isNameChar(e){return _e.isNameCharStart(e)||e>="0"&&e<="9"||"-"===e||"."===e||"·"===e||e>="̀"&&e<="ͯ"||"‿"===e||"⁀"===e}parseHTML(){var e,t=ue(pe.DOCUMENT_FRAGMENT_NODE),s=[t];for(t[f]=this.options,e=this.options.trimWhitespace?this.lexer.skipWhiteSpace():this.lexer.getChar();e!==i&&s.length>0;)"<"===e?this.parseTag(s):this.parseText(s),e=this.options.trimWhitespace?this.lexer.skipWhiteSpace():this.lexer.getChar();return t}parseTag(e){var t,s,r,n,o=0,a=this.lexer.index,l=this.lexer.getNextChar();if(l!==i)e:for(;">"!==l&&l!==i;){if(r=this.lexer.index,0===o){if("!"===l||"?"===l){if(this.options.allowProcessingInstructions&&this.lexer.match("?")){r=this.lexer.index,l=this.lexer.getChar();t:if(_e.isNameCharStart(l)){for(t=ue(pe.PROCESSING_INSTRUCTION_NODE);l!==i&&_e.isNameChar(l);)l=this.lexer.getNextChar();if(!this.lexer.isWhiteSpace(l)&&l!==i&&("?"!==l||">"!==this.lexer.peek()))break t;t.target=this.lexer.str.slice(r,this.lexer.index),this.lexer.skipWhiteSpace(),r=this.lexer.index,this.lexer.goToString("?>"),t.nodeValue=this.lexer.str.slice(r,this.lexer.index),this.lexer.advance(1),e[0].childNodes.push(t),y(t,e[0]);break}this.lexer.advance(r-this.lexer.index-1)}if(this.options.allowCDATA&&this.lexer.match("![CDATA[")){t=ue(pe.CDATA_SECTION_NODE),r=this.lexer.index,this.lexer.goToString("]]>"),t.nodeValue=this.lexer.str.slice(r,this.lexer.index),this.lexer.advance(2),e[0].childNodes.push(t),y(t,e[0]);break}if(this.lexer.match("!DOCTYPE",!1)){this.lexer.skipWhiteSpace(),r=this.lexer.index,this.lexer.goToString(">");let s=e[e.length-1];if(s.doctype)break;if(s.childNodes.length>0)for(let e=s.childNodes.length-1;e>=0;e--)if(s.childNodes[e].nodeType<pe.TEXT_NODE||s.childNodes[e].nodeType>pe.COMMENT_NODE)break e;let i=this.lexer.str.slice(r,this.lexer.index).split(g);if((t=ue(pe.DOCUMENT_TYPE_NODE)).name=Te.call(i.shift()),i.length>1){let e=Te.call(i.shift());if(i=i.join(" ").split('"'),""===i[0])switch(e){case"public":i.shift(),t.publicId=i.shift();case"system":i.shift(),t.systemId=i.shift()}}t.publicId||(t.publicId=""),t.systemId||(t.systemId=""),s.childNodes.push(t),s.doctype=t,y(t,s);break}{let s;this.lexer.match("!--")?this.lexer.match(">")||this.lexer.match("->")||(s="--\x3e"):("!"===l&&this.lexer.getNextChar(),s=">"),t=ue(pe.COMMENT_NODE),r=this.lexer.index,s&&this.lexer.goToString(s),t.nodeValue=this.lexer.str.slice(r,this.lexer.index),this.lexer.advance(s?s.length-1:-1),e[0].childNodes.push(t),y(t,e[0]);break}}"/"===l&&(l=this.lexer.getNextChar(),o=2,r+=1)}if(1===o){for(;this.lexer.index===r&&"="===l||!this.lexer.isWhiteSpace(l)&&!xe[l]&&l!==i;)l=this.lexer.getNextChar();n=this.lexer.index}else{for(;(l>="a"&&l<="z"||l>="A"&&l<="Z"||this.lexer.index>r&&(l>="0"&&l<="9"||"-"===l||"_"===l||":"===l))&&l!==i;)l=this.lexer.getNextChar();if(n=this.lexer.index,l===i)return void this.addTextNode(e,a,n,!1);l=this.lexer.skipWhiteSpace(),2===o&&(l=this.lexer.goToString(">"))}if(r===n){if(!this.options.allowSelfClosingSyntax||"/"!==l||">"!==this.lexer.peek()){if(0===o){this.lexer.goToString("<"),this.addTextNode(e,a,this.lexer.index,!1),a=this.lexer.index,l=this.lexer.getNextChar();continue}if(2===o){if(r===this.lexer.index)break;(t=this.addTextNode(e,r,this.lexer.index))[d]=pe.COMMENT_NODE;break}this.lexer.getNextChar(),l=this.lexer.skipWhiteSpace();continue}l=this.lexer.getNextChar(),o=2,s=e[0][N]}else s=this.lexer.str.slice(r,n),1!==o&&(s=me.call(s)),l=this.lexer.skipWhiteSpace();switch(o){case 0:for((t=ue(pe.ELEMENT_NODE))[N]=s;Se.hasOwnProperty(t[N])&&Se[t[N]][e[0][N]];)e.splice(0,1);e[0].childNodes.push(t),y(t,e[0]),o=1,!0!==T[t[N]]&&e.unshift(t);break;case 1:let a=!0;if(this.options.lowerAttributeCase&&(s=Te.call(s)),"="===l){if(this.lexer.getNextChar(),l=this.lexer.skipWhiteSpace(),r=this.lexer.index,'"'===l||"'"===l)this.lexer.getNextChar(),this.lexer.goToString(l),n=this.lexer.index,r+=1,this.lexer.getNextChar(),l=this.lexer.skipWhiteSpace();else{for(;!(this.lexer.isWhiteSpace(l)||
//!unquotedAttributeExclusions[theChar] &&
">"===l||this.options.allowSelfClosingSyntax&&"/"===l&&">"===this.lexer.peek()||l===i);)l=this.lexer.getNextChar();n=this.lexer.index,l=this.lexer.skipWhiteSpace()}if(t.attributes.hasOwnProperty(s))break;a=this.lexer.str.slice(r,n),""===a?a=!0:this.options.decodeEntities&&(a=this.entityEncoder.decode(a))}else if(t.attributes.hasOwnProperty(s))break;t.attributes[s]=a;break;case 2:for(let i=0;i<e.length;i++)if(e[i][N]===s){for(t=e[i];e.length>0&&e[0]!==t;)e.shift();e.shift();break}}}else this.addTextNode(e,a,this.lexer.index,!1);this.lexer.getNextChar()}parseText(e){var t=this.lexer.index,s=!1;"SCRIPT"===e[0][N]||"STYLE"===e[0][N]?(this.lexer.goToString("</"+e[0][N],!1),s=!0):this.lexer.goToString("<"),this.addTextNode(e,t,this.lexer.index,s)}addTextNode(e,t,s,i){var r=ue(pe.TEXT_NODE),n=this.lexer.str.slice(t,s);return null!=i&&(this.options.trimWhitespace?n=n.trim():this.options.collapseWhitespace&&!i&&(n=n.replace(g," ")),this.options.decodeEntities&&!i&&(n=this.entityEncoder.decode(n))),r.nodeValue=n,e[0].childNodes.push(r),y(r,e[0]),r}}class Ae{constructor(e,t,s,i){var r,n;const o=e instanceof Uint8ClampedArray?e:null;let a="srgb";if(o?(console.log(`[ImageData] Warning: Array initializer support is experimental! ( new ImageData([${o.length}b ${null!==(n=null===(r=null==o?void 0:o.constructor)||void 0===r?void 0:r.name)&&void 0!==n?n:"Array"}], ${Array.from(arguments).slice(1).join(",")}) )`),this.width=t,this.height="number"==typeof s?s:void 0,a=("object"==typeof s?s:"object"==typeof i?i:{colorSpace:"srgb"}).colorSpace):(this.width=e,this.height=t,a=("object"==typeof s?s:{colorSpace:"srgb"}).colorSpace),"srgb"!==a)throw console.log(`[ImageData] Warning: Only the 'srgb' color space is supported! ( new ImageData(${Array.from(arguments).join(",")}) )`),new Error(`Unsupported colorSpace: ${a}`);if(void 0===this.height&&(this.height=o.length/this.width/4),o){if(this.width*this.height*4!==o.length)throw new Error("The array dimensions do not match the supplied width or height");this.data=new Uint8ClampedArray(o)}else this.data=new Uint8ClampedArray(this.width*this.height*4)}}globalThis&&"object"!=typeof globalThis.ImageData&&(globalThis.ImageData=Ae);const Ie=Symbol("fill-style");class Me{get fillStyle(){return this[Ie]}set fillStyle(e){console.log(`${this}→fillStyle = ${e}`),this[Ie]=e}clearRect(e,t,s,i){throw new Error("Not implemented")}fillRect(e,t,s,i){const{r:r,g:n,b:o,a:a}=this.fillStyleRGBA,l=255*a|0,h=this.canvas[$e];if(0!==e||0!==t||h.length!==s*i*4){for(let a=t;a<t+i;++a){const t=4*a+e+s;for(let s=4*a+e;s<t;s+=4)h[s+0]=r,h[s+1]=n,h[s+2]=o,h[s+3]=l}console.log(`${this}→fillRect( ${Array.from(arguments).join(", ")} ) with ${r},${n},${o} @ ${l}`)}else{for(let e=0;e<h.length;e+=4)h[e+0]=r,h[e+1]=n,h[e+2]=o,h[e+3]=l;console.log(`${this}→fillRect( ${Array.from(arguments).join(", ")} ) whole canvas with ${r},${n},${o} @ ${l}`)}}strokeRect(e,t,s,i){throw new Error("Not implemented")}constructor(e){this.canvas=e,this.fillStyle="#000"}drawImage(e,t,s,i,r,n,o,a,l){if(e instanceof globalThis.HTMLCanvasElement){if(i=null!=i?i:e.width,r=null!=r?r:e.height,i!==a||r!==l)return void console.log(`${this} Not implemented: image scaling in drawImage( <${e.constructor.name}> ${Array.from(arguments).join(", ")} )`);const h=e.getContext("2d").getImageData(t,s,i,r),c=h.data,d=this.canvas[$e],u=r,p=i;for(let e=0;e<u;++e)for(let i=0;i<p;++i){const r=4*((s+e)*h.width+t+i),a=c[r],l=c[r+1],u=c[r+2],p=c[r+3],N=4*((o+e)*h.width+n+i),f=d[N],g=d[N+1],E=d[N+2],T=d[N+3],m=1-p/255;d[N+0]=a*(p/255)+f*(T/255)*m|0,d[N+1]=l*(p/255)+g*(T/255)*m|0,d[N+2]=u*(p/255)+E*(T/255)*m|0,d[N+3]=p+T*m|0}console.log(`${this}→drawImage( <${e.constructor.name}> ${Array.from(arguments).join(", ")} )`)}else console.log(`${this} Not implemented: only canvas sources supported: drawImage( <${e.constructor.name}> ${Array.from(arguments).join(", ")} )`)}createImageData(e,t,s){return e instanceof Ae?new Ae(e.data,e.width,e.height):new Ae(e,t,s)}getImageData(e,t,s,i,r){if(0===e&&0===t&&s===this.canvas.width&&i===this.canvas.height&&!r)return console.log(`${this}→getImageData( ${Array.from(arguments).join(", ")} ) whole canvas ${this.canvas.width}x${this.canvas.height}`),new Ae(this.canvas[$e],this.canvas.width,this.canvas.height);console.log(`${this} Not implemented: context2d.getImageData( ${Array.from(arguments).join(", ")} )`);return new Ae(s,i,r)}putImageData(e,t,s,i,r,n,o){let a,l;const h=this.canvas[$e];if(void 0!==i)console.log(`${this} Not implemented: context2d.putImageData( ${Array.from(arguments).join(", ")} )`);else{if(0===t&&0===s&&e.width===this.canvas.width&&e.height===this.canvas.height){console.log(`${this}→putImageData( ${Array.from(arguments).join(", ")} ) whole canvas ${this.canvas.width}x${this.canvas.height}`);for(let t=0;t<e.height;++t)for(let s=0;s<e.width;++s){const i=4*(t*e.width+s),r=e.data[i+3],n=e.data[i+0],o=e.data[i+1],c=e.data[i+2];0===r&&0!=(n|o|c)&&255!=(n&o&c)?l=!0:r<255&&0!=(n|o|c)&&255!=(n&o&c)&&(a=!0),h[i+0]=n,h[i+1]=o,h[i+2]=c,h[i+3]=r}return a&&console.log(`${this} Compat warning: image contained colored non-opaque pixels (alpha<255), the result be inconsistent with observed browser behavior.`),void(l&&console.log(`${this} Compat warning: image contained fully transparent colored pixels (alpha=0), the result of this operation may differ from browser behavior.`))}console.log(`${this} Not implemented: non-whole-canvas putImageData( ${Array.from(arguments).join(", ")} )`)}}setTransform(e,t,s,i,r,n){console.log(`${this} Not implemented: context2d.setTransform( ${Array.from(arguments).join(", ")} )`)}get[Symbol.toStringTag](){return`${this.canvas[Symbol.toStringTag]}::context2d`}get fillStyleRGBA(){let e;return ve.has(this.fillStyle)&&(e=Re(ve.get(this.fillStyle)),e)?e:(e=Re(this.fillStyle),e||(e=Re(this.fillStyle),e||{r:0,g:0,b:0,a:1}))}}const ve=new Map([["black","#000000"],["silver","#c0c0c0"],["gray","#808080"],["white","#ffffff"],["maroon","#800000"],["red","#ff0000"],["purple","#800080"],["fuchsia","#ff00ff"],["green","#008000"],["lime","#00ff00"],["olive","#808000"],["yellow","#ffff00"],["navy","#000080"],["blue","#0000ff"],["teal","#008080"],["aqua","#00ffff"]]);function Re(e){var t,s;let i,r,n=0,o=0,a=0,l=0;return i=null===(t=e.match(/^#(?<r>[0-9a-f]{2})(?<g>[0-9a-f]{2})(?<b>[0-9a-f]{2})(?<a>[0-9a-f]{2})?$/))||void 0===t?void 0:t.groups,(null==i?void 0:i.r)&&(null==i?void 0:i.g)&&(null==i?void 0:i.b)&&(n=parseInt(i.r,16),o=parseInt(i.g,16),a=parseInt(i.b,16),l=i.a?parseInt(i.a,10):1,r=!0),i=null===(s=e.match(/^#(?<r>[0-9a-f]{1})(?<g>[0-9a-f]{1})(?<b>[0-9a-f]{1})(?<a>[0-9a-f]{1})?$/))||void 0===s?void 0:s.groups,(null==i?void 0:i.r)&&(null==i?void 0:i.g)&&(null==i?void 0:i.b)&&(n=parseInt(i.r,16),o=parseInt(i.g,16),a=parseInt(i.b,16),l=i.a?parseInt(i.a,10):1,r=!0),r?{r:n,g:o,b:a,a:l}:(console.log(`Not a HTML color string: ${e}`),null)}const Le=Symbol("canvas-width"),Ue=Symbol("canvas-height"),ke=Symbol("canvas-context"),Pe=Symbol("element-id"),$e=Symbol("accesscanvas-data");class We extends pe{get width(){return console.debug(`${this}→width? (${this[Le]})`),this[Le]}get height(){return console.debug(`${this}→height? (${this[Ue]})`),this[Ue]}set width(e){console.debug(`${this}→width = ${e}`),this[Le]=e,this.resize(this[Le],this[Ue])}set height(e){console.debug(`${this}→height = ${e}`),this[Ue]=e,this.resize(this[Le],this[Ue])}getContext(e,t){if("2d"!=e)throw new Error(`Not implemented: ${e}`);if(this[ke]=this[ke]||new Me(this),!(this[ke]instanceof Me))throw new Error("Context invalid");return this[ke]}toDataURL(e="image/png",t){throw new Error("Not implemented")}toBlob(e,t="image/png",s){throw new Error("Not implemented")}get clientWidth(){return this.width}get clientHeight(){return this.height}constructor(){super(de),this[Pe]=(Math.random()*Math.pow(36,6)|0).toString(36),this.resize(300,150)}get[Symbol.toStringTag](){return`HTMLCanvasElement#${this[Pe]}`}resize(e,t){this[Le]=e,this[Ue]=t,this[$e]=new Uint8ClampedArray(this[Le]*this[Ue]*4),console.debug(`${this}→reset, new size: ${this[Le]}x${this[Ue]} (${this[$e].length}b)`)}}globalThis&&"object"!=typeof globalThis.HTMLCanvasElement&&(globalThis.HTMLCanvasElement=We);const Ge=/&(#\d+|#[xX][0-9a-fA-F]+|[0-9a-zA-Z]+);?/g,je=/[\^$\\.*+?()[\]{}|]/g,Be=Ye({amp:"&",apos:"'",copy:169,gt:">",lt:"<",nbsp:160,quot:'"'});let He=Be;class Fe{constructor(e){this.entities=e||"default"}encode(e,t){return this.encodingReplacements?e.replace(t instanceof RegExp?C(t):this.encodingRE,(e=>this.encodingReplacements[e]||e)):e}decode(e){return this.decodingReplacements?e.replace(Ge,((e,t)=>"#"===t[0]?(t="x"===t[1]||"X"===t[1]?0|parseInt(t.slice(2),16):0|t.slice(1),String.fromCodePoint(t)):this.decodingReplacements[t]||this.decodingReplacements[t.toLowerCase()]||e)):e}set entities(e){"default"===e?e=He:e&&e.encodingRE instanceof RegExp||(e=Ye(e)),this.encodingRE=e.encodingRE,this.encodingReplacements=e.encodingReplacements,this.decodingReplacements=e.decodingReplacements}static set defaultEntities(e){He=e&&"object"==typeof e?Ye(Object.assign({},e)):Be}}function Ye(e){var t={encodingRE:null,encodingReplacements:null,decodingReplacements:null};if(e&&"object"==typeof e){const s={},i={},r=[];for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];if(Number.isFinite(n))n=String.fromCodePoint(n);else if("string"!=typeof n||""===n)continue;r.push(n.replace(je,"\\$&")),(!s.hasOwnProperty(n)||t.length+2<s[n].length)&&(s[n]="&"+t+";"),i[t]=n}r.length>0&&(t.encodingRE=new RegExp(r.join("|"),"g"),t.encodingReplacements=s,t.decodingReplacements=i)}return t.encodingRE||(t.encodingRE=new RegExp("(?:)","g")),t}const Ve=Symbol("entityEncoder");class Xe extends pe{constructor(e,t){const s=ue(pe.DOCUMENT_FRAGMENT_NODE,Xe);return s[f]=_e.setupOptions(t),s[Ve]=new Fe(s[f].entities),s.innerHTML=e,s}get documentElement(){return this[c]||null}get innerHTML(){let e="";for(let t=0;t<this.childNodes.length;t++)e+=ae(this.childNodes[t]);return e}set innerHTML(e){if(this[d]=pe.DOCUMENT_FRAGMENT_NODE,e&&"string"==typeof e){const t=new _e(e,this[f],this[Ve]).parseHTML();x(this.childNodes),t.doctype?this[a]=t.doctype:this[a]=null,this.childNodes=t.childNodes;for(let e=0;e<this.childNodes.length;e++)y(this.childNodes[e],this);m(this)}else this.childNodes.length=0}get outerHTML(){return null}set outerHTML(e){}get doctype(){return this[a]||null}set doctype(e){if(e){let t=this[a];e instanceof pe?e.nodeType===pe.DOCUMENT_TYPE_NODE&&e!==t&&(this[a]=e,t?this.replaceChild(e,t):this.insertBefore(e,this.firstChild)):"object"==typeof e&&(t?qe(t,e.name,e.publicId,e.systemId):this[a]=this.insertBefore(this.createDocumentType(e.name,e.publicId,e.systemId),this.firstChild))}else null===e&&this[a]&&(this.removeChild(this[a]),this[a]=null)}get head(){return this[l]||null}get title(){const e=this.head;if(e){const t=e.getElementsByTagName("title");if(t.length>0)return t[0].textContent}return""}set title(e){const t=this.head;if(t){let s=t.getElementsByTagName("title");s=s.length<=0?t.appendChild(this.createElement("title")):s[0],s.textContent=e}}get body(){return this[h]||null}set body(e){e instanceof pe&&e.nodeType===pe.ELEMENT_NODE&&("BODY"===e.tagName||"FRAMESET"===e.tagName)&&e!==this[h]&&this[c]&&(this[h]?this[h].parentNode.replaceChild(e,this[h]):this[c].appendChild(e))}get entityEncoder(){return this[Ve]}createElement(e){if(e&&"string"==typeof e){const t=function(e){if("canvas"===e.toLowerCase())return function(e){const t=new We;switch(t[d]=e,t.nodeValue=null,t[u]=null,t[p]=null,e){case pe.ELEMENT_NODE:t[N]=null,t.attributes={};case pe.DOCUMENT_NODE:case pe.DOCUMENT_FRAGMENT_NODE:t.childNodes=[]}return t}(pe.ELEMENT_NODE);return ue(pe.ELEMENT_NODE)}(e);return t[N]=e.toUpperCase(),t}}createTextNode(e){return ze(pe.TEXT_NODE,e)}createComment(e){return ze(pe.COMMENT_NODE,e)}createCDATASection(e){return ze(pe.CDATA_SECTION_NODE,e,"]]>")}createProcessingInstruction(e,t){e:if(e&&"string"==typeof e){if(!_e.isNameCharStart(e[0]))break e;for(let t=1;t<e.length;t++)if(!_e.isNameChar(e[t]))break e;const s=ze(pe.PROCESSING_INSTRUCTION_NODE,t,"?>");return s.target=e,s}throw new Error("Invalid target name "+JSON.stringify(e)+".")}createDocumentType(e,t,s){return qe(ue(pe.DOCUMENT_TYPE_NODE),e,t,s)}getElementsByName(e){const t=[];return e&&"string"==typeof e&&this.forEach((s=>{s.attributes&&s.attributes.name===e&&t.push(s)})),t}}function ze(e,t,s=!1){const i=ue(e);if(i.nodeValue="",t&&"string"==typeof t){if(s&&"string"==typeof s&&-1!==t.indexOf(s))throw new Error("The data provided ('"+t+"') contains '"+s+"'.");i.nodeValue+=t}return i}function qe(e,t,s,i){return t&&"string"==typeof t?(e.name=t.toLowerCase(),e.publicId=s&&"string"==typeof s?s:"",e.systemId=i&&"string"==typeof i?i:""):e.name=e.publicId=e.systemId="",e}Xe.Node=pe,Xe.EntityEncoder=Fe,module.exports=Xe;
